{"version":3,"sources":["../../.src/web/env/dom.js"],"names":["getNode","el","select","undefined","isElement","Element","getBoundingRect","x","y","left","top","width","height","right","bottom","valid","doc","document","win","window","body","offsetX","pageXOffset","documentElement","parentNode","scrollLeft","offsetY","pageYOffset","scrollTop","boundingRect","getBoundingClientRect","parent","getElementBoundingRect","elRect","toJSON","current","html","test","getComputedStyle","getPropertyValue","windowRect","screenLeft","screenX","screenTop","screenY","outerWidth","outerHeight","screenRect","screen","SVGBuilder","drawVariants","prototype","addPath","points","attributes","push","tag","params","createElement","svgTag","createElementNS","realMaxWidth","realMaxHeigth","forEach","pathElement","setAttribute","dValue","point","index","prefix","appendChild","makeSVG"],"mappings":"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","sourcesContent":["import { rect } from \"../../modules/dimension\";\nimport { likeArray, isNode } from \"../../functions/isLike\";\n\nexport const getNode = function(el){\n  let select = likeArray(el) ? el[0] : el;\n  return isNode(select) ? select : undefined;\n};\n\nexport const isElement = function(el){\n  return el instanceof Element;\n};\n\nexport const getBoundingRect = function(el){\n  el = getNode(el);\n  \n  if(!isElement(el)){\n    return rect({\n      x:0,y:0,left:0,top:0,width:0,height:0,right:0,bottom:0,valid:false\n    });\n  }\n  \n  const doc = document;\n  const win = window;\n  const body = doc.body;\n\n  let offsetX = win.pageXOffset !== undefined ? win.pageXOffset :\n  (doc.documentElement || body.parentNode || body).scrollLeft;\n  let offsetY = win.pageYOffset !== undefined ? win.pageYOffset :\n  (doc.documentElement || body.parentNode || body).scrollTop;\n  \n  const boundingRect = el.getBoundingClientRect();\n\n  if (el !== body) {\n    var parent = el.parentNode;\n\n    while (parent !== body) {\n      offsetX += parent.scrollLeft;\n      offsetY += parent.scrollTop;\n      parent   = parent.parentNode;\n    }\n  }\n  \n  return rect({\n    x     : boundingRect.left + offsetX,\n    y     : boundingRect.top + offsetY,\n    left  : boundingRect.left + offsetX,\n    top   : boundingRect.top + offsetY,\n    width : boundingRect.width,\n    height: boundingRect.height,\n    right : boundingRect.right + offsetX,\n    bottom: boundingRect.bottom + offsetY,\n    valid : true\n  });\n}\n\nexport const getElementBoundingRect = function(el){\n  el = getNode(el);\n  \n  const doc  = document;\n  const win  = window;\n  \n  const elRect = getBoundingRect(el).toJSON();\n  \n  if(elRect.valid === false){\n    return rect(elRect);\n  }\n  \n  let current = el;\n  let parent  = el.parentNode;\n  \n  do {\n    if(parent && (!parent.html && !parent.body)  && /absoute|relative|fixed/.test(win.getComputedStyle(parent).getPropertyValue(\"position\"))){\n      const { top, left } = getBoundingRect(parent);\n      elRect.top   -= top;\n      elRect.left  -= left;\n      elRect.right  = elRect.left + elRect.width;\n      elRect.bottom = elRect.top + elRect.height;\n      current = parent = null;\n    } else if(!parent) {\n      current = null;\n    } else {\n      current = parent;\n      parent = current.parentNode;\n    }\n  } while( !!parent )\n  \n  return rect(elRect);\n}\n\nexport const windowRect = function(){\n  return rect({\n    left:window.screenLeft || window.screenX,\n    top:window.screenTop || window.screenY,\n    width:window.outerWidth,\n    height:window.outerHeight\n  });\n}\n\nexport const screenRect = function(){\n  return rect({\n    left:0,\n    top:0,\n    width:screen.width,\n    height:screen.height\n  });\n}\n\nconst SVGBuilder = function(){\n  this.drawVariants = [];\n};\n\nSVGBuilder.prototype = {\n  addPath (points,attributes){\n    this.drawVariants.push({\n      tag:\"path\",\n      attributes,\n      params:points\n    })\n    return this;\n  },\n  createElement (){\n    const svgTag = document.createElementNS('http://www.w3.org/2000/svg', \"svg\");\n    let realMaxWidth  = 0;\n    let realMaxHeigth = 0; \n    \n    this.drawVariants.forEach(({ tag, attributes, params})=>{\n      if( tag === \"path\"){\n        const pathElement = document.createElementNS('http://www.w3.org/2000/svg', \"path\");\n        \n        if(typeof attributes !== \"object\"){\n          attributes = {};\n        }\n        \n        pathElement.setAttribute(\"fill\", attributes['fill'] || \"transparent\");\n        pathElement.setAttribute(\"stroke\", attributes['stroke'] || \"gray\");\n        pathElement.setAttribute(\"stroke-width\", attributes['strokeWidth'] || attributes['stroke-width'] || \"1\");\n        pathElement.setAttribute(\"stroke-linecap\",\"butt\");\n        pathElement.setAttribute(\"stroke-linejoin\",\"miter\");\n        \n        let dValue = \"\";\n        \n        params.forEach((point, index)=>{\n          const prefix = index === 0 ? 'M' : 'L';\n          if(point.x > realMaxWidth) realMaxWidth = point.x;\n          if(point.y > realMaxHeigth) realMaxHeigth = point.y;\n          dValue += `${prefix}${point.x} ${point.y} `;\n        });\n        \n        pathElement.setAttribute(\"d\",dValue);\n        svgTag.appendChild(pathElement);\n      }\n    });\n    svgTag.setAttribute(\"style\",\"overflow:visible;\");\n    svgTag.setAttribute(\"width\",realMaxWidth);\n    svgTag.setAttribute(\"height\",realMaxHeigth);\n    return svgTag;\n  }\n}\n\nexport const makeSVG = function(){\n  return new SVGBuilder();\n}"],"file":"dom.js"}