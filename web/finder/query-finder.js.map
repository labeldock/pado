{"version":3,"sources":["../../.src/web/finder/query-finder.js"],"names":["findLite","find","fc","i","l","length","fs","concat","push","fa","findByOnePlace","findse","rootNode","N","node","trace","result","fd","findBySeveralPlaces","root","arguments","W","document","targetRoots","findes","fi","fl","fdr","queryFind","eq","queryFindMember","sel","offset","target","parentElement","children","currentIndex","Array","from","parentNode","forEach"],"mappings":"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","sourcesContent":["import { unique } from '../../functions/functions'\nimport { asArray, toArray } from '../../functions/cast'\nimport { isPlainObject, isArray, isNode } from '../../functions/isLike'\nimport { is, query, nodelist } from './query-selector'\n\nconst findLite = function(find){\n  if( typeof find === 'string' ){\n    // [string,null]\n    return query(find);\n  } else if(isNode(find)){\n    // [node]\n    return [find];\n  }  else if(isArray(find)) {\n    // [array]\n    var fc = [];\n    for(var i=0,l=find.length;i<l;i++) { \n      if( typeof find[i] === 'string' ) {\n        // [array][string]\n        var fs = query(find[i]);\n        if(fs.length) fc = fc.concat( fs );\n      } else if(isNode(find[i])) {\n        // [array][node]\n        fc.push(find[i]);\n      } else if(isArray(find[i])){\n        var fa = findLite(find[i]);\n        if(fa.length) fc = fc.concat( fa );\n      }\n    }\n    return unique(fc);\n  }\n  return [];\n};\n//여러개의 셀럭터와 하나의 루트노드만 허용\nconst findByOnePlace = function(findse,rootNode){\n  if(typeof findse === 'string') return query(findse,rootNode);\n  if( isNode(findse) ) {\n    var fs = query(N.node.trace(findse),rootNode);\n    for(var i=0,l=fs.length;i<l;i++) if(findse === fs[i]) return [findse];\n  }\n  if( isArray(findse) ) {\n    var result = [];\n    for(var i=0,l=findse.length;i<l;i++) {\n      var fd = findByOnePlace(findse[i],rootNode);\n      if( fd.length ) result = result.concat(fd);\n    }\t\t\t\t\n    return unique(result);\n  }\n  return [];\n};\n\nconst findBySeveralPlaces = function(find,root){\n  if(arguments.length === 1 || typeof root === 'undefined' || root === null || root === W.document ) return findLite(find);\n  // find root\n  var targetRoots = findLite(root);\n  if(targetRoots.length === 0) {\n    return findLite(find);\n  }\n  //\n  var findes = toArray(find);\n  var result = [];\n  for(var i=0,l=targetRoots.length;i<l;i++) {\n    for(var fi=0,fl=findes.length;fi<fl;fi++) {\n      var fdr = findByOnePlace(findes[fi],targetRoots[i]);\n      if( fdr.length ) result = result.concat(fdr);\n    }\n  }\n  return unique(result);\n};\n\nconst queryFind = function(find,root,eq){\n  return (typeof root === \"number\") ? findLite(find)[root] :\n  (typeof eq === \"number\")   ? findBySeveralPlaces(find,root)[eq] :\n  findBySeveralPlaces(find,root);\n};\n\nconst queryFindMember = function(sel,offset){\n  var target = findLite(sel)[0];\n  if(!isNode(target)) return;\n  if(typeof offset !== \"number\") return toArray(target.parentElement.children);\n  var currentIndex = -1;\n  Array.from(target.parentNode.children).forEach((node,i)=>{ if(target == node) { currentIndex = i; return false; } });\n  return target.parentNode.children[currentIndex+offset];\n};\n\nexport {\n  queryFind,\n  queryFindMember\n}"],"file":"query-finder.js"}