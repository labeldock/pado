{"version":3,"sources":["../.src/modules/affect.js"],"names":["ManualReactive","watch","effect","judgeOfEqual","a","b","oldValue","undefined","prototype","beginAffect","watchValue","digest","args","watchResult","apply","affect","affectValue","manualReactive","value"],"mappings":";;;;;;;;;;;;;;;;;;;;AAGA,MAAMA,iBAAiB,SAAjBA,cAAiB,CAASC,KAAT,EAAgBC,MAAhB,EAAwBC,YAAxB,EAAqC;AAC1D,SAAKF,KAAL,GAAoBA,KAApB;AACA,SAAKC,MAAL,GAAoBA,MAApB;AACA,SAAKC,YAAL,GAAoB,OAAOA,YAAP,KAAwB,UAAxB,GAAqCA,YAArC,GAAoD,UAACC,CAAD,EAAGC,CAAH;AAAA,aAAOD,MAAIC,CAAX;AAAA,KAAxE;AACA,SAAKC,QAAL,GAAoBC,SAApB;AACD,GALD;;AAOAP,iBAAeQ,SAAf,GAA2B;AACzBC,eADyB,uBACZC,UADY,EACD;AACtB,WAAKR,MAAL,CAAYQ,UAAZ,EAAuB,0BAAU,KAAKJ,QAAf,CAAvB;AACA,WAAKA,QAAL,GAAgBI,UAAhB;AACD,KAJwB;AAKzBC,UALyB,oBAKT;AAAA,wCAALC,IAAK;AAALA,YAAK;AAAA;;AACd,UAAMC,cAAc,KAAKZ,KAAL,CAAWa,KAAX,CAAiB,IAAjB,EAAsBF,IAAtB,CAApB;AACA,aAAO,KAAKT,YAAL,CAAkB,KAAKG,QAAvB,EAAiCO,WAAjC,IAAgD,KAAhD,IAAyD,KAAKJ,WAAL,CAAiBI,WAAjB,GAA+B,IAAxF,CAAP;AACD;AARwB,GAA3B;;AAWO,MAAME,SAAS,SAATA,MAAS,CAASb,MAAT,EAAiBC,YAAjB,EAA8B;AAClD,QAAIa,cAAmBT,SAAvB;AACA,QAAMU,iBAAiB,IAAIjB,cAAJ,CAAmB;AAAA,aAAIgB,WAAJ;AAAA,KAAnB,EAAoCd,MAApC,EAA4CC,YAA5C,CAAvB;AACA,WAAO,UAACe,KAAD,EAAS;AAAEF,oBAAYE,KAAZ;AAAmBD,qBAAeN,MAAf;AAA0B,KAA/D;AACD,GAJM","sourcesContent":["import { isEqual } from '../functions/isLike'\nimport { cloneDeep } from '../functions'\n\nconst ManualReactive = function(watch, effect, judgeOfEqual){\n  this.watch        = watch;\n  this.effect       = effect;\n  this.judgeOfEqual = typeof judgeOfEqual === \"function\" ? judgeOfEqual : (a,b)=>a===b;\n  this.oldValue     = undefined;\n};\n\nManualReactive.prototype = {\n  beginAffect (watchValue){\n    this.effect(watchValue,cloneDeep(this.oldValue));\n    this.oldValue = watchValue;\n  },\n  digest (...args){\n    const watchResult = this.watch.apply(this,args);\n    return this.judgeOfEqual(this.oldValue, watchResult) ? false : (this.beginAffect(watchResult), true);\n  }\n}\n\nexport const affect = function(effect, judgeOfEqual){\n  let affectValue      = undefined;\n  const manualReactive = new ManualReactive(()=>affectValue, effect, judgeOfEqual);\n  return (value)=>{ affectValue=value; manualReactive.digest(); };\n}"],"file":"affect.js"}