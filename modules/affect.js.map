{"version":3,"sources":["../.src/modules/affect.js"],"names":["ManualReactive","watch","effect","judgeOfEqual","a","b","oldValue","undefined","prototype","beginAffect","watchValue","digest","args","watchResult","apply","affect","affectValue","manualReactive","value"],"mappings":";;;;;;;;;;;;;;;;;;;;AAEA,MAAMA,cAAc,GAAG,SAAjBA,cAAiB,CAAUC,KAAV,EAAiBC,MAAjB,EAAyBC,YAAzB,EAAsC;AAC3D,SAAKF,KAAL,GAAaA,KAAb;AACA,SAAKC,MAAL,GAAcA,MAAd;AACA,SAAKC,YAAL,GAAoB,OAAOA,YAAP,KAAwB,UAAxB,GAAqCA,YAArC,GAAoD,UAACC,CAAD,EAAIC,CAAJ;AAAA,aAAQD,CAAC,KAAKC,CAAd;AAAA,KAAxE;AACA,SAAKC,QAAL,GAAgBC,SAAhB;AACD,GALD;;AAOAP,EAAAA,cAAc,CAACQ,SAAf,GAA2B;AACzBC,IAAAA,WADyB,uBACZC,UADY,EACD;AACtB,WAAKR,MAAL,CAAYQ,UAAZ,EAAwB,0BAAU,KAAKJ,QAAf,CAAxB;AACA,WAAKA,QAAL,GAAgBI,UAAhB;AACD,KAJwB;AAKzBC,IAAAA,MALyB,oBAKT;AAAA,wCAALC,IAAK;AAALA,QAAAA,IAAK;AAAA;;AACd,UAAMC,WAAW,GAAG,KAAKZ,KAAL,CAAWa,KAAX,CAAiB,IAAjB,EAAuBF,IAAvB,CAApB;AACA,aAAO,KAAKT,YAAL,CAAkB,KAAKG,QAAvB,EAAiCO,WAAjC,IAAgD,KAAhD,IAAyD,KAAKJ,WAAL,CAAiBI,WAAjB,GAA+B,IAAxF,CAAP;AACD;AARwB,GAA3B;;AAWO,MAAME,MAAM,GAAG,SAATA,MAAS,CAAUb,MAAV,EAAkBC,YAAlB,EAA+B;AACnD,QAAIa,WAAJ;AACA,QAAMC,cAAc,GAAG,IAAIjB,cAAJ,CAAmB;AAAA,aAAIgB,WAAJ;AAAA,KAAnB,EAAoCd,MAApC,EAA4CC,YAA5C,CAAvB;AACA,WAAO,UAACe,KAAD,EAAS;AAAEF,MAAAA,WAAW,GAAGE,KAAd;AAAqBD,MAAAA,cAAc,CAACN,MAAf;AAAyB,KAAhE;AACD,GAJM","sourcesContent":["import { cloneDeep } from '../functions'\n\nconst ManualReactive = function (watch, effect, judgeOfEqual){\n  this.watch = watch\n  this.effect = effect\n  this.judgeOfEqual = typeof judgeOfEqual === \"function\" ? judgeOfEqual : (a, b)=>a === b\n  this.oldValue = undefined\n}\n\nManualReactive.prototype = {\n  beginAffect (watchValue){\n    this.effect(watchValue, cloneDeep(this.oldValue))\n    this.oldValue = watchValue\n  },\n  digest (...args){\n    const watchResult = this.watch.apply(this, args)\n    return this.judgeOfEqual(this.oldValue, watchResult) ? false : (this.beginAffect(watchResult), true)\n  }\n}\n\nexport const affect = function (effect, judgeOfEqual){\n  let affectValue\n  const manualReactive = new ManualReactive(()=>affectValue, effect, judgeOfEqual)\n  return (value)=>{ affectValue = value; manualReactive.digest() }\n}\n"],"file":"affect.js"}