{"version":3,"sources":["../.src/modules/stance.js"],"names":["likePoint","p","hasOwnProperty","Point","x","y","z","w","meta","__ref","__meta","__matrix","__computed","matrixVersion","computedVersion","memoizeRef","memoizeOutput","compute","key","needCompute","newMemoizeRef","newComputedMatrix","reduce","dest","matrix","Object","defineProperties","enumerable","get","length","set","v","it","rx","console","log","range","width","rangeWidth","ry","rangeHeight","height","addMatrix","value","Error","push","prototype","addMeta","obj","assign","clone","call","fn","toJSON","withMeta","json","pull","angle","xHalf","Vertex","vertexWith","destPoint","points","unshift","rectWith","largeX","smallX","largeY","smallY","Rect","pointArray","forEach","point","classFunction","methods","keys","start","end","result","eq","index","join","joins","refp","i","newp","splice","order","px","py","pz","pw","sx","sy","sz","sw","ex","ey","ez","ew","transform","rect","useRect","left","top","originX","originY","translate","newValue","oldValue","offsetValue","right","bottom","splitCountParser","split","columnOrder","rowOrder","column","parseInt","row","findPoint","findWord","trim","lineFind","pointFind","vertex","inheritMeta","perspective","perspectiveOrigin","middleY","centerX","piecesWithCount","splitCount","eachResultHook","pieceWidth","pieceHeight","undefined","pacResult","colIndex","rowIndex","pacMeta","coords","sticky","position","refX","refY","refWidth","refHeight","valid"],"mappings":"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","sourcesContent":["import { isArray, isNumber } from '../functions/isLike';\nimport { asArray } from '../functions/cast';\nimport { asMatrix, validMatrix, multiplyMatrix } from '../functions/matrix';\nimport { makeMatrixArray } from './matrix';\n\n\nconst likePoint = function(p){\n  return typeof p === \"object\" && p.hasOwnProperty(\"x\") && p.hasOwnProperty(\"y\");\n}\n\n\nconst Point = function(x=0,y=0,z=0,w=1,meta){\n  // base point config\n  const __ref = { x,y,z,w };\n  let __meta;\n  \n  // compute matrix\n  const __matrix   = [];\n  const __computed = {\n    matrixVersion:0,\n    computedVersion:0,\n    memoizeRef:null,\n    memoizeOutput:null\n  };\n  \n  const compute = (key)=>{\n    const { matrixVersion, computedVersion } = __computed;\n    //why un used?\n    //const { memoizeRef } = __computed;\n    \n    let needCompute = !__computed.memoizeRef || matrixVersion !== computedVersion || !(\n      __computed.memoizeRef.x === __ref.x &&\n      __computed.memoizeRef.y === __ref.y &&\n      __computed.memoizeRef.z === __ref.z &&\n      __computed.memoizeRef.w === __ref.w \n    );\n    \n    if(needCompute){\n      const newMemoizeRef = {\n        x:__ref.x,\n        y:__ref.y,\n        z:__ref.z,\n        w:__ref.w\n      };\n      const newComputedMatrix = __matrix.reduce(\n        (dest, matrix)=>multiplyMatrix(matrix,dest),\n        asMatrix([newMemoizeRef.x,newMemoizeRef.y,newMemoizeRef.z,newMemoizeRef.w],1)\n      );\n      //\n      __computed.memoizeOutput   = {\n        x:newComputedMatrix[0][0],\n        y:newComputedMatrix[0][1],\n        z:newComputedMatrix[0][2],\n        w:newComputedMatrix[0][3]\n      };\n      __computed.memoizeRef      = newMemoizeRef;\n      __computed.computedVersion = matrixVersion;\n    } \n    //else {\n    //  console.log(`compute cache ${key}`);\n    //}\n    return key && __computed.memoizeOutput[key] || __computed.memoizeOutput;\n  };\n  \n  Object.defineProperties(this,{\n    x:{ enumerable:true, get:()=>(__matrix.length &&  compute('x') || __ref.x), set:v=>__ref.x = v},\n    y:{ enumerable:true, get:()=>(__matrix.length &&  compute('y') || __ref.y), set:v=>__ref.y = v},\n    z:{ enumerable:true, get:()=>(__matrix.length &&  compute('z') || __ref.z), set:v=>__ref.z = v},\n    w:{ enumerable:true, get:()=>(__matrix.length &&  compute('w') || __ref.w), set:v=>__ref.w = v},\n    meta:{\n      enumerable:false, \n      get(){ return __meta },\n      set(it){ __meta = typeof it === \"object\" ? it : null; return __meta; }\n    },\n    rx:{ enumerable:false, get:()=>{\n      console.log(\"rx\",this.meta && this.meta.range && this.meta.range.width, this.x)\n        const rangeWidth = (this.meta && this.meta.range && this.meta.range.width) || 0;\n        return this.x / rangeWidth;\n      }\n    },\n    ry:{ \n      enumerable:false, get:()=>{\n        const rangeHeight = (this.meta && this.meta.range && this.meta.range.height) || 0;\n        return this.y / rangeHeight;\n      }\n    },\n    addMatrix: {\n      enumerable:false,\n      value:function(matrix){\n        if(!validMatrix(matrix)) throw new Error(\"invalid addMatrix param\");\n        __matrix.push(matrix);\n        __computed.matrixVersion+=1;\n        return this;\n      }\n    }\n  });\n  this.meta = meta;\n};\n\nPoint.prototype = {\n  addMeta (obj){\n    if(typeof obj === \"object\") this.meta = Object.assign(this.meta&&this.meta||{},obj);\n    return this;\n  },\n  clone (){\n    return new Point(this.x,this.y,this.z,this.w,this.meta);\n  },\n  call (fn){\n    if(typeof fn === \"function\"){\n      return fn(this) || this;\n    }\n    return this;\n  },\n  toJSON (withMeta){\n    const json = { x:this.x, y:this.y, z:this.z, w:this.w };\n    if(withMeta === true && this.meta) json.meta = this.meta;\n    return json;\n  },\n  pull (width=0, angle=\"horizontal\"){\n    const { x, y, z, w } = this;\n    switch(angle){\n      case \"h\": case \"horizontal\":\n        const xHalf = width <= 0 ? 0 : width/2;\n        return new Vertex([{x:x-xHalf, y, z, w}, {x:x+xHalf, y, z, w}]);\n      default:\n    }\n  },\n  vertexWith (destPoint){\n    const points = asArray(destPoint);\n    points.unshift(this);\n    return new Vertex(points);\n  },\n  rectWith ({x, y}){\n    const [largeX, smallX] = this.x > x ? [ this.x, x ] : [ x, this.x ];\n    const [largeY, smallY] = this.y > y ? [ this.y, y ] : [ y, this.y ];\n    return new Rect(smallX,smallY,largeX-smallX,largeY-smallY,0,0);\n  }\n};\n\nconst Vertex = function(pointArray,meta){\n  let __meta;\n  \n  Object.defineProperties(this,{\n    meta:{\n      enumerable:false, \n      get(){ return __meta },\n      set(it){ __meta = typeof it === \"object\" ? it : null; return __meta; }\n    }\n  });\n  \n  this.meta = meta;\n  \n  asArray(pointArray).forEach(point=>{\n    if(!likePoint(point)) return;\n    const {x,y,z,w} = point;\n    this.push(new Point(x,y,z,w,__meta));\n  });\n};\n\n(function(classFunction, methods){\n  const prototype = [];\n  \n  classFunction.prototype = prototype;\n  \n  Object.keys(methods).forEach(key=>{\n    prototype[key] = methods[key]\n  });\n  \n  Object.defineProperties(prototype,{\n    start:{\n      enumerable:false,\n      get (){\n        return this[0];\n      }\n    },\n    end:{\n      enumerable:false,\n      get (){\n        return !this.length ? void 0 : this[this.length-1];\n      }\n    }\n  });\n}(Vertex, {\n  addMeta (obj){\n    if(typeof obj === \"object\") this.meta = Object.assign(this.meta&&this.meta||{},obj);\n    return this;\n  },\n  toJSON (withMeta){\n    const result = [];\n    this.forEach(p=>result.push(p.toJSON(withMeta)));\n    return result;\n  },\n  clone (){\n    return new Vertex(this);\n  },\n  eq (index){\n    return this[index];\n  },\n  join:function(fn){\n    const joins = [];\n    this.forEach((refp,i)=>{\n      joins.push(refp);\n      if(!this[i+1]) return;\n      const newp = fn(refp, this[i+1], i);\n      if(!likePoint(newp)) return;\n      const {x,y,z,w,meta} = newp;\n      joins.push(new Point(x,y,z,w,meta));\n    });\n    this.splice(0,this.length);\n    joins.forEach(p=>this.push(p));\n    return this;\n  },\n  point (order){\n    console.log(\" point this.meta\",this.meta)\n    switch(order){\n    case \"e\": case \"end\":\n    case \"d\": case \"down\": case \"r\": case \"right\":\n      const { x:px,y:py,z:pz,w:pw } = this.end;\n      return new Point(\n        px,\n        py,\n        pz,\n        pw,\n        this.meta\n      );\n    case \"c\": case \"m\": case \"center\": case \"middle\":\n      const { x:sx, y:sy, z:sz, w:sw } = this.start;\n      const { x:ex, y:ey, z:ez, w:ew } = this.end;\n      return new Point(\n        sx/2 + ex/2,\n        sy/2 + ey/2,\n        sz/2 + ez/2,\n        sw/2 + ew/2,\n        this.meta\n      );\n    case \"s\": case \"start\":\n    case \"u\": case \"up\": case \"l\": case \"left\":\n    default:\n      const { x,y,z,w } = this.start;\n      return new Point(\n        x,\n        y,\n        z,\n        w,\n        this.meta\n      );\n    }\n  },\n  transform (transform,rect){\n    const useRect = !!rect;\n    \n    if(useRect){\n      const { left, top, width, height } = rect;;\n      \n      //rotateOrigin\n      const originX = left + width/2;\n      const originY = top + height/2;\n      \n      this.forEach(point=>{\n        const { left, top } = rect;\n        point.translate({ x:-originX, y:-originY });\n        point.transform(transform);\n        point.translate({ x:originX, y:originY });\n      });\n    } else {\n      this.forEach(point=>{\n        point.transform(transform)\n      });\n    }\n    return this;\n  }\n}));\n\n\n\nconst Rect = function(left=0,top=0,width=0,height=0,meta=null){\n  const __ref = { left,top,width,height }\n  let __meta;\n  Object.defineProperties(this,{\n    width:{ \n        enumerable:true, \n        get(){ return __ref.width; },\n        set(newValue){\n            const oldValue = __ref.width;\n            const offsetValue = newValue - oldValue;\n            __ref.width = newValue;\n            __ref.right += offsetValue;\n            return newValue;\n        }\n    },\n    height:{ \n        enumerable:true, \n        get(){ return __ref.height; },\n        set(newValue){\n            const oldValue = __ref.height;\n            const offsetValue = newValue - oldValue;\n            __ref.height = newValue;\n            __ref.bottom    += offsetValue;\n            return newValue;\n        }\n    },\n    left:{ enumerable:true, get(){ return __ref.left; } },\n    top:{ enumerable:true, get(){ return __ref.top; } },\n    right:{ enumerable:true, get(){ return this.left + this.width; } },\n    bottom:{ enumerable:true, get(){ return this.top + this.height; } },\n    meta:{\n      enumerable:false, \n      get(){ return __meta },\n      set(it){ \n        __meta = typeof it === \"object\" ? it : null; \n        return __meta;\n      }\n    }\n  });\n  \n  this.meta = meta;\n};\n\nconst splitCountParser = (split)=>{\n    //splitCount [ horizental, vertical ]\n    //1 = [ 1 ]\n    //[1, 2] = [1, 2]\n  const [ columnOrder, rowOrder ] = asArray(split);\n  return {\n    column: isNumber(columnOrder) && columnOrder > 0 ? parseInt(columnOrder,10) : 1,\n    row   : isNumber(rowOrder)    && rowOrder > 0    ? parseInt(rowOrder,10)    : 1\n  }\n}\n\nRect.prototype = {\n  addMeta (obj){\n    if(typeof obj === \"object\") this.meta = Object.assign(this.meta&&this.meta||{},obj);\n    return this;\n  },\n  toJSON (withMeta){\n    const json = {width:this.width, height:this.height, left:this.left, top:this.top, right:this.right, bottom:this.bottom };\n    if(withMeta === true && this.meta) json.meta = this.meta;\n    return json;\n  },\n  findPoint (findWord){\n    const [ lineFind, pointFind ] = isArray(findWord) ? findWord : findWord.trim().split(/\\s+/);\n    return this.vertex(lineFind).point(pointFind);\n  },\n  vertex (order){\n    const inheritMeta = Object.assign({\n      perspective:0,\n      perspectiveOrigin:{\n        x:this.left + (this.width / 2),\n        y:this.top  + (this.top / 2),\n        z:0\n      }\n    },this.meta);\n    \n    switch(order){\n    case \"right\": case \"r\":\n      return new Vertex([{x:this.right, y:this.top, z:0, w:0},{x:this.right,y:this.bottom,z:0,w:0}],inheritMeta);\n    case \"bottom\": case \"b\":\n      return new Vertex([{x:this.left, y:this.bottom, z:0, w:0},{x:this.right,y:this.bottom,z:0,w:0}],inheritMeta);\n    case \"left\": case \"l\":\n      return new Vertex([{x:this.left, y:this.top, z:0, w:0},{x:this.left,y:this.bottom,z:0,w:0}],inheritMeta);\n    case \"top\": case \"t\":\n      return new Vertex([{x:this.left, y:this.top, z:0, w:0},{x:this.right,y:this.top,z:0,w:0}],inheritMeta);\n    case \"middle\": case \"m\":\n      const middleY = this.height/2+this.top;\n      return new Vertex(\n        [\n          {x:this.left,  y:middleY, z:0, w:0},\n          {x:this.right, y:middleY, z:0, w:0}\n        ],\n        inheritMeta\n      );\n    case \"center\": case \"c\":\n      const centerX = this.width/2+this.x;\n      return new Vertex(\n        [\n          {x:centerX, y:this.top,   z:0, w:0},\n          {x:centerX, y:this.bottom, z:0,w:0}\n        ],\n        inheritMeta\n      );\n    default:\n      return new Vertex(\n        [\n          {x:this.left,  y:this.top, z:0, w:0},\n          {x:this.left,  y:this.bottom,z:0,w:0},\n          {x:this.right, y:this.bottom,z:0,w:0},\n          {x:this.right, y:this.top, z:0, w:0}\n        ],\n        inheritMeta\n      );\n    }\n  },\n  piecesWithCount (splitCount, eachResultHook){\n    const { column, row } = splitCountParser(splitCount);\n    const width = this.width;\n    const height = this.height;\n    const pieceWidth = width / column;\n    const pieceHeight = height / row;\n    eachResultHook = typeof eachResultHook === \"function\" ? eachResultHook : undefined;\n    \n    const pacResult = makeMatrixArray(column, row, (index, colIndex, rowIndex)=>{\n      const pacMeta = { \n        column: colIndex,\n        row   : rowIndex,\n        coords: [colIndex, rowIndex], \n        range : { width, height }\n      };\n      const result = new Rect(colIndex*pieceWidth, rowIndex*pieceHeight, pieceWidth, pieceHeight, pacMeta);\n      return eachResultHook ? eachResultHook(result,index,colIndex,rowIndex) : result;\n    });\n    \n    return pacResult;\n  },\n  //TODO : incompleted sticky(parent, position, offset);\n  sticky ({left:refX, top:refY, width:refWidth, height:refHeight}, position=\"bottom left\"){\n    const { left, top, width, height } = this;\n    switch(position){\n    case \"bl\": case \"obl\": case \"bottom left\": case \"outer bottom left\":\n      return rect({\n        left:refX,\n        top:refY+refHeight,\n        width,\n        height\n      });\n    case \"c\": case \"m\": case \"mc\": case \"center\": case \"middle\": case \"middle center\":\n      return rect({\n        left:refX + refWidth/2 - width/2,\n        top:refY + refHeight/2 - height/2,\n        width,\n        height\n      });\n    default:\n      return rect({ left, top, width, height });\n    }\n  }\n};\n\nexport const point = function(x,y,z,w){\n  return typeof x === \"object\" ? \n  new Point(x.x,x.y,x.z,x.w) : \n  new Point(x,y,z,w);\n};\n\nexport const vertex = function(start,end){\n  new Vertex([{x:start.x,y:start.y,z:start.z,w:start.w},{x:end.x,y:end.y,z:end.z,w:end.w}]);\n};\n\nexport const rect = function(left,top,width,height,x,y,valid){\n  return typeof left === \"object\" ?\n  new Rect(left.left,left.top,left.width,left.height,left.x,left.y,left.valid) :\n  new Rect(left,top,width,height,x,y,valid);\n};\n"],"file":"stance.js"}