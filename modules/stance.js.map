{"version":3,"sources":["../.src/modules/stance.js"],"names":["likePoint","p","hasOwnProperty","calcTransformedPoint","__ref","matrix","perspectiveOrigin","transformPoint","x","y","z","px","py","pz","w","Point","meta","__meta","__transformedPoint","Object","defineProperties","enumerable","get","transform","set","undefined","v","it","assign","configurable","writable","value","rx","rangeWidth","range","width","ry","rangeHeight","height","prototype","addMeta","obj","clone","call","fn","toJSON","withMeta","json","pull","angle","xHalf","Vertex","vertexWith","destPoint","points","unshift","rectWith","largeX","smallX","largeY","smallY","Rect","applyTransform","matrix44","Error","pointArray","forEach","point","push","classFunction","methods","keys","key","start","end","length","result","eq","index","join","joins","refp","i","newp","splice","order","pw","sx","sy","sz","sw","ex","ey","ez","ew","rect","first","left","right","top","bottom","d","l","param","newValue","oldValue","splitCountParser","split","columnOrder","rowOrder","column","parseInt","row","defaultPerspective","perspective","findPoint","findWord","trim","lineFind","pointFind","vertex","inheritMeta","middleY","centerX","transformRect","piecesWithCount","splitCount","eachResultHook","pieceWidth","pieceHeight","pacExt","Array","pacResult","colIndex","rowIndex","pacMeta","coords","diff","aleft","atop","awidth","aheight","aright","abottom","diffResult","original","offset","want","over","move","nleft","ntop","fit","WHRatio","transformRatio","sort","sticky","position","refX","refY","refWidth","refHeight","valid"],"mappings":"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","sourcesContent":["import { isArray, isNumber } from '../functions/isLike'\nimport { asArray } from '../functions/cast'\nimport { validMatrix, multiplyMatrix } from '../functions/matrix'\nimport { makeMatrixArray } from './matrix'\n\n\nconst likePoint = function (p){\n  return typeof p === \"object\" && p.hasOwnProperty(\"x\") && p.hasOwnProperty(\"y\")\n}\n\nconst calcTransformedPoint = (__ref, { matrix, perspectiveOrigin })=>{\n  // yet support affin\n  //let perspectiveVar = (this.meta && this.meta.perspective)\n  //perspectiveVar = !isNumber(perspectiveVar) ? 0 : perspectiveVar;\n  //perspectiveVar = -1/perspectiveVar;\n  //perspectiveVar = isInfinity(perspectiveVar) ? 0 : (perspectiveVar || 0) ;\n  if(!matrix) return\n  \n  const transformPoint = {}\n  const {x:px = 0, y:py = 0, z:pz = 0} = perspectiveOrigin || {x: 0, y: 0, z: 0}\n  const [[x], [y], [z], [w]] = multiplyMatrix(matrix, [[__ref.x - px], [__ref.y - py], [__ref.z - pz], [__ref.w]])\n  \n  transformPoint.x = x + px + matrix[0][3]\n  transformPoint.y = y + py + matrix[1][3]\n  transformPoint.z = z + pz + matrix[2][3]\n  transformPoint.w = w\n  \n  return transformPoint\n}\n\nconst Point = function (x = 0, y = 0, z = 0, w = 1, meta){\n  // base point config\n  const __ref = { x, y, z, w }\n  let __meta = {}\n  let __transformedPoint\n  \n  Object.defineProperties(this, {\n    x: { \n      enumerable: true,\n      get       : ()=>{\n        if(this.transform === true){\n          !__transformedPoint && (__transformedPoint = calcTransformedPoint(__ref, this.meta))\n          return __transformedPoint ? __transformedPoint.x : __ref.x\n        }\n        return __ref.x\n      }, \n      set: v=>{\n        __transformedPoint = undefined\n        __ref.x = v\n      }\n    },\n    y: { \n      enumerable: true,\n      get       : ()=>{\n        if(this.transform === true){\n          !__transformedPoint && (__transformedPoint = calcTransformedPoint(__ref, this.meta))\n          return __transformedPoint ? __transformedPoint.y : __ref.y\n        }\n        return __ref.y\n      }, \n      set: v=>{\n        __transformedPoint = undefined\n        __ref.y = v\n      }\n    },\n    z: { \n      enumerable: true,\n      get       : ()=>{\n        if(this.transform === true){\n          !__transformedPoint && (__transformedPoint = calcTransformedPoint(__ref, this.meta))\n          return __transformedPoint ? __transformedPoint.z : __ref.z\n        }\n        return __ref.z\n      }, \n      set: v=>{\n        __transformedPoint = undefined\n        __ref.z = v\n      }\n    },\n    w: { \n      enumerable: true,\n      get       : ()=>{\n        if(this.transform === true){\n          !__transformedPoint && (__transformedPoint = calcTransformedPoint(__ref, this.meta))\n          return __transformedPoint ? __transformedPoint.w : __ref.w\n        }\n        return __ref.w\n      }, \n      set: v=>{\n        __transformedPoint = undefined\n        __ref.w = v\n      }\n    },\n    meta: {\n      enumerable: false, \n      get (){ return __meta },\n      set (it){ \n        typeof it === \"object\" && Object.assign(__meta, it)\n        __transformedPoint = undefined\n        return __meta\n      }\n    },\n    transform: {\n      enumerable  : false,\n      configurable: false,\n      writable    : true,\n      value       : false\n    },\n    rx: { enumerable: false,\n      get       : ()=>{\n        const rangeWidth = (this.meta && this.meta.range && this.meta.range.width) || 0\n        return this.x / rangeWidth\n      }\n    },\n    ry: { \n      enumerable: false,\n      get       : ()=>{\n        const rangeHeight = (this.meta && this.meta.range && this.meta.range.height) || 0\n        return this.y / rangeHeight\n      }\n    }\n  })\n  \n  if(typeof meta === \"object\"){\n    this.meta = meta\n  }\n}\n\nPoint.prototype = {\n  addMeta (obj){\n    if(typeof obj === \"object\") this.meta = Object.assign(this.meta && this.meta || {}, obj)\n    return this\n  },\n  clone (){\n    return new Point(this.x, this.y, this.z, this.w, this.meta)\n  },\n  call (fn){\n    if(typeof fn === \"function\"){\n      return fn(this) || this\n    }\n    return this\n  },\n  toJSON (withMeta){\n    const json = { x: this.x, y: this.y, z: this.z, w: this.w }\n    if(withMeta === true && this.meta) json.meta = this.meta\n    return json\n  },\n  pull (width = 0, angle = \"horizontal\"){\n    const { x, y, z, w } = this\n    switch (angle){\n      case \"h\": case \"horizontal\":\n        const xHalf = width <= 0 ? 0 : width / 2\n        return new Vertex([{x: x - xHalf, y, z, w}, {x: x + xHalf, y, z, w}])\n      default:\n    }\n  },\n  vertexWith (destPoint){\n    const points = asArray(destPoint)\n    points.unshift(this)\n    return new Vertex(points)\n  },\n  rectWith ({x, y}){\n    const [largeX, smallX] = this.x > x ? [ this.x, x ] : [ x, this.x ]\n    const [largeY, smallY] = this.y > y ? [ this.y, y ] : [ y, this.y ]\n    return new Rect(smallX, smallY, largeX - smallX, largeY - smallY, 0, 0)\n  },\n  applyTransform (matrix44 = this.meta.matrix){\n    if(!validMatrix(matrix44)){\n      this.transform = false\n      throw new Error('Point::applyTransform invalid matrix', matrix44)\n      return this\n    }\n    \n    this.meta.matrix = matrix44\n    this.transform = true\n    return this\n  }\n}\n\nconst Vertex = function (pointArray, meta){\n  let __meta\n  \n  Object.defineProperties(this, {\n    meta: {\n      enumerable: false, \n      get (){ return __meta },\n      set (it){ __meta = typeof it === \"object\" ? it : null; return __meta }\n    }\n  })\n  \n  this.meta = meta\n  \n  asArray(pointArray).forEach(point=>{\n    if(!likePoint(point)) return\n    const {x, y, z, w} = point\n    this.push(new Point(x, y, z, w, __meta))\n  })\n};\n\n(function (classFunction, methods){\n  const prototype = []\n  \n  classFunction.prototype = prototype\n  \n  Object.keys(methods).forEach(key=>{\n    prototype[key] = methods[key]\n  })\n  \n  Object.defineProperties(prototype, {\n    start: {\n      enumerable: false,\n      get (){\n        return this[0]\n      }\n    },\n    end: {\n      enumerable: false,\n      get (){\n        return !this.length ? void 0 : this[this.length - 1]\n      }\n    }\n  })\n}(Vertex, {\n  addMeta (obj){\n    if(typeof obj === \"object\") this.meta = Object.assign(this.meta && this.meta || {}, obj)\n    return this\n  },\n  toJSON (withMeta){\n    const result = []\n    this.forEach(p=>result.push(p.toJSON(withMeta)))\n    return result\n  },\n  clone (){\n    return new Vertex(this)\n  },\n  eq (index){\n    return this[index]\n  },\n  join: function (fn){\n    const joins = []\n    this.forEach((refp, i)=>{\n      joins.push(refp)\n      if(!this[i + 1]) return\n      const newp = fn(refp, this[i + 1], i)\n      if(!likePoint(newp)) return\n      const {x, y, z, w, meta} = newp\n      joins.push(new Point(x, y, z, w, meta))\n    })\n    this.splice(0, this.length)\n    joins.forEach(p=>this.push(p))\n    return this\n  },\n  point (order){\n    switch (order){\n      case \"e\": case \"end\":\n      case \"d\": case \"down\": case \"r\": case \"right\":\n        const { x:px, y:py, z:pz, w:pw } = this.end\n        return new Point(\n          px,\n          py,\n          pz,\n          pw,\n          this.meta\n        )\n      case \"c\": case \"m\": case \"center\": case \"middle\":\n        const { x:sx, y:sy, z:sz, w:sw } = this.start\n        const { x:ex, y:ey, z:ez, w:ew } = this.end\n        return new Point(\n          sx / 2 + ex / 2,\n          sy / 2 + ey / 2,\n          sz / 2 + ez / 2,\n          sw / 2 + ew / 2,\n          this.meta\n        )\n      case \"s\": case \"start\":\n      case \"u\": case \"up\": case \"l\": case \"left\":\n      default:\n        const { x, y, z, w } = this.start\n        return new Point(\n          x,\n          y,\n          z,\n          w,\n          this.meta\n        )\n    }\n  },\n  rect (){\n    const first = this[0]\n    \n    if(!first){\n      return new Rect(0, 0, 0, 0)\n    }\n    \n    let left = first.x\n    let right = first.x\n    let top = first.y\n    let bottom = first.y\n    \n    for(let d = this, i = 1, l = this.length; i < l; i++){\n      const p = d[i]\n      p.x < left && (left = p.x)\n      p.x > right && (right = p.x)\n      p.y < top && (top = p.y)\n      p.y > bottom && (bottom = p.y)\n    }\n    \n    return new Rect(left, top, right - left, bottom - top)\n  },\n  applyTransform (param){\n    this.forEach(p=>p.applyTransform(param))\n    return this\n  }\n}))\n\n\nconst Rect = function (left = 0, top = 0, width = 0, height = 0, meta = null){\n  const __ref = { left, top, width, height }\n  let __meta = {}\n  \n  Object.defineProperties(this, {\n    width: { \n      enumerable: true, \n      get (){ return __ref.width },\n      set (newValue){\n        const oldValue = __ref.width\n        __ref.width = newValue\n        __ref.right += newValue - oldValue\n        return newValue\n      }\n    },\n    height: { \n      enumerable: true, \n      get (){ return __ref.height },\n      set (newValue){\n        const oldValue = __ref.height\n        __ref.height = newValue\n        __ref.bottom += newValue - oldValue\n        return newValue\n      }\n    },\n    left  : { enumerable: true, get (){ return __ref.left } },\n    top   : { enumerable: true, get (){ return __ref.top } },\n    right : { enumerable: true, get (){ return this.left + this.width } },\n    bottom: { enumerable: true, get (){ return this.top + this.height } },\n    meta  : {\n      enumerable: false, \n      get (){ return __meta },\n      set (it){ \n        typeof it === \"object\" && Object.assign(__meta, it)\n        return __meta\n      }\n    }\n  })\n  \n  if(typeof meta === \"object\"){\n    this.meta = meta\n  }\n}\n\nconst splitCountParser = (split)=>{\n    //splitCount [ horizental, vertical ]\n    //1 = [ 1 ]\n    //[1, 2] = [1, 2]\n  const [ columnOrder, rowOrder ] = asArray(split)\n  return {\n    column: isNumber(columnOrder) && columnOrder > 0 ? parseInt(columnOrder, 10) : 1,\n    row   : isNumber(rowOrder) && rowOrder > 0 ? parseInt(rowOrder, 10) : 1\n  }\n}\n\nRect.prototype = {\n  addMeta (obj){\n    if(typeof obj === \"object\") this.meta = Object.assign(this.meta && this.meta || {}, obj)\n    return this\n  },\n  clone (){\n    return new Rect(this.left, this.top, this.width, this.height, this.meta)\n  },\n  toJSON (withMeta){\n    const json = {width: this.width, height: this.height, left: this.left, top: this.top, right: this.right, bottom: this.bottom }\n    if(withMeta === true && this.meta) json.meta = this.meta\n    return json\n  },\n  defaultPerspective (){\n    return {\n      perspective      : 0,\n      perspectiveOrigin: {\n        x: this.left + (this.width / 2),\n        y: this.top + (this.height / 2),\n        z: 0\n      }\n    }\n  },\n  findPoint (findWord){\n    const [ lineFind, pointFind ] = isArray(findWord) ? findWord : findWord.trim().split(/\\s+/)\n    return this.vertex(lineFind).point(pointFind)\n  },\n  vertex (order){\n    const inheritMeta = Object.assign(this.defaultPerspective(), this.meta)\n    \n    switch (order){\n      case \"right\": case \"r\":\n        return new Vertex([{x: this.right, y: this.top, z: 0, w: 0}, {x: this.right, y: this.bottom, z: 0, w: 0}], inheritMeta)\n      case \"bottom\": case \"b\":\n        return new Vertex([{x: this.left, y: this.bottom, z: 0, w: 0}, {x: this.right, y: this.bottom, z: 0, w: 0}], inheritMeta)\n      case \"left\": case \"l\":\n        return new Vertex([{x: this.left, y: this.top, z: 0, w: 0}, {x: this.left, y: this.bottom, z: 0, w: 0}], inheritMeta)\n      case \"top\": case \"t\":\n        return new Vertex([{x: this.left, y: this.top, z: 0, w: 0}, {x: this.right, y: this.top, z: 0, w: 0}], inheritMeta)\n      case \"middle\": case \"m\":\n        const middleY = this.height / 2 + this.top\n        return new Vertex(\n          [\n            {x: this.left, y: middleY, z: 0, w: 0},\n            {x: this.right, y: middleY, z: 0, w: 0}\n          ],\n          inheritMeta\n        )\n      case \"center\": case \"c\":\n        const centerX = this.width / 2 + this.x\n        return new Vertex(\n          [\n            {x: centerX, y: this.top, z: 0, w: 0},\n            {x: centerX, y: this.bottom, z: 0, w: 0}\n          ],\n          inheritMeta\n        )\n      default:\n        return new Vertex(\n          [\n            {x: this.left, y: this.top, z: 0, w: 0},\n            {x: this.left, y: this.bottom, z: 0, w: 0},\n            {x: this.right, y: this.bottom, z: 0, w: 0},\n            {x: this.right, y: this.top, z: 0, w: 0}\n          ],\n          inheritMeta\n        )\n    }\n  },\n  transformRect (){\n    this.vertex()\n  },\n  piecesWithCount (splitCount, eachResultHook){\n    const { column, row } = splitCountParser(splitCount)\n    const width = this.width\n    const height = this.height\n    const pieceWidth = width / column\n    const pieceHeight = height / row\n    eachResultHook = typeof eachResultHook === \"function\" ? eachResultHook : undefined\n    \n    \n    const pacExt = { ...this.defaultPerspective() }\n    \n    if(this.meta.matrix && this.meta.matrix instanceof Array){\n      Object.assign(pacExt, {\n        matrix: this.meta.matrix\n      })\n    }\n    \n    const pacResult = makeMatrixArray(column, row, (index, colIndex, rowIndex)=>{\n      const pacMeta = { \n        column: colIndex,\n        row   : rowIndex,\n        coords: [colIndex, rowIndex], \n        range : { width, height },\n        ...pacExt\n      }\n      \n      //\n      const result = new Rect(colIndex * pieceWidth, rowIndex * pieceHeight, pieceWidth, pieceHeight, pacMeta)\n      return eachResultHook ? eachResultHook(result, index, colIndex, rowIndex) : result\n    })\n    \n    return pacResult\n  },\n  diff ({ left:aleft, top:atop, width:awidth, height:aheight, right:aright, bottom:abottom }){\n    const diffResult = {}\n    const original = this.toJSON()\n    const offset = {left: 0, top: 0}\n    Object.defineProperties(diffResult, {\n      left: {\n        enumerable: true, \n        get       : ()=>original.left - aleft + offset.left,\n        set       : (want)=>{ offset.left = typeof want === \"number\" ? -original.left + want : 0 }\n      },\n      top: {\n        enumerable: true,\n        get       : ()=>original.top - atop + offset.top,\n        set       : (want)=>{ offset.top = typeof want === \"number\" ? -original.top + want : 0 }\n      },\n      width : { enumerable: true, get: ()=>original.width - awidth},\n      height: { enumerable: true, get: ()=>original.height - aheight},\n      right : { enumerable: true, get: ()=>original.right - aright + offset.left},\n      bottom: { enumerable: true, get: ()=>original.bottom - abottom + offset.top},\n      x     : { enumerable: false, get: ()=>offset.left},\n      y     : { enumerable: false, get: ()=>offset.top},\n      offset: {\n        enumerable: false,\n        get       : ()=>()=>({\n          x     : offset.left,\n          y     : offset.top,\n          right : diffResult.right,\n          bottom: diffResult.bottom,\n          over  : diffResult.right > diffResult.bottom ? diffResult.right : diffResult.bottom\n        })\n      },\n      move: {\n        enumerable: false,\n        get       : ()=>(nleft, ntop)=>{\n          diffResult.left = typeof nleft === \"number\" ? nleft : aleft\n          diffResult.top = typeof ntop === \"number\" ? ntop : atop\n          return diffResult\n        }\n      },\n      toJSON: {\n        enumerable: false,\n        get       : ()=>()=>({ ...diffResult })\n      }\n    })\n    \n    return diffResult\n  },\n  fit (rect){\n    if(typeof rect !== \"object\"){ throw new Error(\"fit::argument[0] is not object\") }\n    const { width, height } = rect\n    \n    if(!isNumber(width) || !isNumber(height)){ throw new Error(\"fit::argument[0] is not { width:Number, height:Number }\") }\n    const WHRatio = [ width / this.width, height / this.height ]\n    const transformRatio = WHRatio.sort()[0]\n    \n    this.width = (this.width * transformRatio) || 0\n    this.height = (this.height * transformRatio) || 0\n    \n    return this\n  },\n  //TODO : incompleted sticky(parent, position, offset);\n  sticky ({left:refX, top:refY, width:refWidth, height:refHeight}, position = \"bottom left\"){\n    const { left, top, width, height } = this\n    switch (position){\n      case \"bl\": case \"obl\": case \"bottom left\": case \"outer bottom left\":\n        return rect({\n          left: refX,\n          top : refY + refHeight,\n          width,\n          height\n        })\n      case \"c\": case \"m\": case \"mc\": case \"center\": case \"middle\": case \"middle center\":\n        return rect({\n          left: refX + refWidth / 2 - width / 2,\n          top : refY + refHeight / 2 - height / 2,\n          width,\n          height\n        })\n      default:\n        return rect({ left, top, width, height })\n    }\n  }\n}\n\nexport const point = function (x, y, z, w){\n  return typeof x === \"object\" \n    ? new Point(x.x, x.y, x.z, x.w) \n    : new Point(x, y, z, w)\n}\n\nexport const vertex = function (start, end){\n  return new Vertex([{x: start.x, y: start.y, z: start.z, w: start.w}, {x: end.x, y: end.y, z: end.z, w: end.w}])\n}\n\nexport const rect = function (left, top, width, height, x, y, valid){\n  return typeof left === \"object\"\n    ? new Rect(left.left, left.top, left.width, left.height, left.x, left.y, left.valid)\n    : new Rect(left, top, width, height, x, y, valid)\n}\n"],"file":"stance.js"}