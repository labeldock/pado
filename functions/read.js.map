{"version":3,"sources":["../.src/functions/read.js"],"names":["readString","rebaseMatches","matches","text","castFn","props","payload","content","newMatchEntries","castingState","firstIndex","lastIndex","length","castingStart","cursor","start","open","matchEntries","parentScope","matchesMap","map","matchType","matchExp","firstMatch","sort","a","aPriority","b","bPriority","matchIndex","matchSize","castStart","castEnd","castSize","skipSize","matching","casting","scope","fork","next","needCursor","cursorTo","enter","enterMatches","enterCastFn","exit","more","readPath","__filterDotPath","dotPath","removeFirstDot","indexOf","substr","__filterBlockPath","blockPath","substring","test","parseInt","pathParam","path","push","stackCount","result","get","target","defaultValue","allget","name","hasOwnProperty","call","apply","Array","prototype","slice","arguments","hasProperty","hasValue","defaultObjectValueFunc","object","value","functionKeyObjectValueProc","functionKey","Boolean","selectKeyObjectValueProc","leftSelect","rightSelect","useLeftSelector","useRightSelector","obj","key","getKey","proc","i","l","objKey"],"mappings":"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","sourcesContent":["import {\n  isArray,\n  likeString,\n  likeObject,\n  isNumber,\n  isEmpty\n} from './isLike'\n\nimport {\n  entries,\n  matchString\n} from './remark'\n\nimport {\n  all\n} from './enumerable'\n\nimport {\n  asArray\n} from './cast'\n\n\n//read.readString.spec.js\nexport const readString = (function (){\n  const rebaseMatches = matches=>entries(asArray(matches))\n  return function (text, matches, castFn, props){\n    const payload = {\n      content: text,\n      props\n    }\n  \n    const newMatchEntries = rebaseMatches(matches)\n  \n    const castingState = {\n      firstIndex  : 0,\n      lastIndex   : text.length,\n      castingStart: 0,\n      cursor      : 0\n    }\n    \n    if(typeof props === \"object\" && isNumber(props.start)){\n      castingState.castingStart = props.start\n      castingState.cursor = props.start\n    }\n\n    const open = function ({ castingState:{ firstIndex, lastIndex, castingStart, cursor }, matchEntries, castFn, parentScope }){\n      if(cursor >= lastIndex){\n        return false\n      }\n      \n      //find match\n      const matchesMap = matchEntries.map(([matchType, matchExp])=>([matchString(text, matchExp, cursor), matchType, matchExp]))\n      let firstMatch   = asArray(matchesMap).sort(([a, aPriority], [b, bPriority])=>(\n        a[0] < 0 ? true\n        : b[0] < 0 ? false\n        : a[0] == b[0] ? aPriority < bPriority : a[0] > b[0]\n      ))[0]\n      \n      // top match is not exsist\n      if(!firstMatch){ return false }\n      \n      // unmatched\n      if(firstMatch[0][0] === -1){\n        firstMatch = [[-1, 0], -1, null]\n      }\n\n      //next variant\n      const [[ matchIndex, matchSize ], matchType, matchExp] = firstMatch\n      const castStart = castingStart\n      const castEnd   = matchType === -1 ? lastIndex : (matchIndex + matchSize)\n      const castSize  = castEnd - castStart\n      const skipSize  = castSize - matchSize\n      \n      //next params\n      const matching = { \n        matchType, \n        matchExp,\n        matchIndex,\n        matchSize,\n        skipSize\n      }\n      const casting = {\n        firstIndex,\n        lastIndex,\n        castStart,\n        castEnd,\n        castSize\n      }\n      const scope = {\n        fork (matchEntries, castFn){\n          const newMatchEntries = rebaseMatches(matches)\n          open({\n            castingState: {\n              firstIndex  : matching.matchIndex,\n              lastIndex   : matching.matchIndex + matchSize,\n              castingStart: matching.matchIndex,\n              cursor      : matching.matchIndex\n            }, \n            matchEntries: newMatchEntries,\n            castFn,\n            parentScope\n          })\n        },\n        next (needCursor){\n          const cursorTo = isNumber(needCursor) ? needCursor : casting.castEnd\n          open({\n            castingState: {\n              firstIndex,\n              lastIndex,\n              castingStart: cursorTo,\n              cursor      : cursorTo\n            },\n            matchEntries,\n            castFn,\n            parentScope\n          })\n        },\n        enter (enterMatches, enterCastFn){\n          open({\n            castingState: {\n              firstIndex,\n              lastIndex,\n              castingStart: matching.matchIndex,\n              cursor      : matching.matchIndex\n            },\n            matchEntries: rebaseMatches(enterMatches),\n            castFn      : enterCastFn,\n            parentScope : {\n              next: scope.next\n            }\n          })\n        },\n        exit (needCursor){\n          parentScope && parentScope.next(isNumber(needCursor) ? needCursor : casting.castEnd)\n        },\n        more (){\n          open({\n            castingState: {\n              firstIndex,\n              lastIndex,\n              castingStart: castStart,\n              cursor      : casting.castEnd\n            },\n            matchEntries,\n            castFn,\n            parentScope\n          })\n        }\n      }\n      \n      castFn({\n        ...payload,\n        ...matching,\n        ...casting,\n        ...scope\n      })\n      \n      return true\n    }\n    \n    open({\n      castingState,\n      matchEntries: newMatchEntries,\n      castFn\n    })\n  \n    return payload\n  }\n}())\n\nexport const readPath = (function (){\n  const __filterDotPath = (dotPath, removeFirstDot)=>removeFirstDot && dotPath.indexOf(\".\") === 0 ? dotPath.substr(1) : dotPath\n  const __filterBlockPath = (blockPath)=>{\n    //remove []\n    blockPath = blockPath.substring(1, blockPath.length - 1)\n    \n    //interger\n    if(/^[0-9]+$/.test(blockPath)){\n      return parseInt(blockPath, 10)\n    }\n    \n    //remove ''\n    if(/^\\'.*\\'$/.test(blockPath) || /^\\\".*\\\"$/.test(blockPath)){\n      blockPath = blockPath.substring(1, blockPath.length - 1)\n    }\n    return blockPath\n  }\n\n  return function (pathParam){\n    if(isArray(pathParam)){\n      return pathParam\n    }\n  \n    if(likeString(pathParam)){\n      if(isNumber(pathParam)){\n        return [pathParam]\n      }\n    \n      if(typeof pathParam === \"string\"){\n        //one depth\n        if(!/\\.|\\[/.test(pathParam)){\n          return [pathParam]\n        }\n        \n        //multiple depth\n        const { props:{ path:result } } = readString(pathParam, [\".\", \"[\"], ({\n          content, props:{ path }, matchExp, castStart, castEnd, castSize, skipSize, enter, next\n        })=>{\n          if(matchExp === \".\"){\n            skipSize && path.push(content.substr(castStart, skipSize))\n            next()\n          }\n          if(matchExp === \"[\"){\n            let stackCount = 0\n          \n            if(skipSize){\n              path.push(__filterDotPath(content.substr(castStart, skipSize), castStart !== 0))\n            }\n          \n            enter([\"[\", \"]\"], ({ matchExp, castStart, castEnd, more, exit })=>{\n              if(matchExp === \"[\") stackCount++\n              if(matchExp === \"]\") stackCount--\n              if(matchExp === null) return\n              if(stackCount === 0){\n                path.push(__filterBlockPath(content.substring(castStart, castEnd)))\n                exit()\n              } else {\n                more()\n              }\n            })\n          }\n          if(matchExp === null){\n            path.push(__filterDotPath(content.substr(castStart, castEnd), castStart !== 0))\n          }\n        }, { path: [] })\n      \n        return result\n      }\n    }\n    return []\n  }\n}())\n\nexport const get = function (target, path, defaultValue){\n  if(typeof target === \"object\"){\n    switch (typeof path){\n      case \"number\": path += \"\"\n      case \"string\":\n        path = readPath(path)\n      case \"object\":\n        if(isArray(path)){\n          const allget = all(path, (name)=>{\n            if(likeObject(target) && (target.hasOwnProperty(name) || target[name])){\n              target = target[name]\n              return true\n            } else {\n              return false\n            }\n          })\n          return allget ? target : defaultValue\n        } else {\n          return\n        }\n        break\n      case \"function\": return path.call(this, target)\n    }\n  } else if(typeof target === \"function\"){\n    return target.apply(this, Array.prototype.slice.call(arguments, 1))\n  }\n  return target\n}\n\nexport const hasProperty = function (target, pathParam){\n  return all(readPath(pathParam), path=>{\n    if(likeObject(target) && likeString(path) && target.hasOwnProperty(path)){\n      target = target[path]\n      return true\n    }\n    return false\n  })\n}\n\nexport const hasValue = (function (){\n  const defaultObjectValueFunc = function (object, value){\n    return object === value\n  }\n    \n  const functionKeyObjectValueProc = function (functionKey){\n    return function (object, value){\n      return Boolean(functionKey(object, value))\n    }\n  }\n    \n  const selectKeyObjectValueProc = function (leftSelect, rightSelect){\n    var useLeftSelector  = (typeof leftSelect === \"string\" || typeof leftSelect === \"number\")\n    var useRightSelector = leftSelect === rightSelect ? useLeftSelector : (typeof rightSelect === \"string\" || typeof rightSelect === \"number\")\n        \n    return function (object, value){\n      if(useLeftSelector && !object.hasOwnProperty(leftSelect)) return false\n      if(useRightSelector && !value.hasOwnProperty(rightSelect)) return false\n            \n      return (useLeftSelector ? get(object, leftSelect) : object) === (useRightSelector ? get(value, rightSelect) : value)\n    }\n  }\n    \n  return function (obj, value, key, getKey){\n    if(typeof key === \"boolean\"){\n      if(typeof getKey !== \"boolean\"){\n        getKey = key\n      }\n      key = void 0\n    }\n        \n    if(obj === value){\n      return true\n    } else if(likeObject(obj)){\n      if(value === (void 0) && key === (void 0)) return !isEmpty(obj)\n            \n      var proc\n            \n      if(key){\n        if(typeof key === \"function\"){\n          proc = functionKeyObjectValueProc(key)\n        } else if(isArray(key) && key.length > 1){\n          proc = selectKeyObjectValueProc(key[0], key[1])\n        } else if(typeof key === \"string\" || typeof key === \"number\"){\n          proc = selectKeyObjectValueProc(key, key)\n        }\n      } else {\n        proc = defaultObjectValueFunc\n      }\n            \n      if(isArray(obj)){\n        for(var i = 0, l = obj.length; i < l; i++) if(proc(obj[i], value)) return getKey ? i : true\n      } else {\n        for(var objKey in obj) if(obj.hasOwnProperty(objKey) && proc(obj[objKey], value)) return getKey ? objKey : true \n      }\n    }\n        \n    return getKey ? void 0 : false\n  }\n}())\n"],"file":"read.js"}