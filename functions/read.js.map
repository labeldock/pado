{"version":3,"sources":["../packages/pado/functions/read.js"],"names":["readString","rebaseMatches","matches","text","castFn","props","payload","content","newMatchEntries","castingState","firstIndex","lastIndex","length","castingStart","cursor","start","open","matchEntries","parentScope","matchesMap","map","matchType","matchExp","firstMatch","sort","a","aPriority","b","bPriority","matchIndex","matchSize","castStart","castEnd","castSize","skipSize","matching","casting","scope","fork","next","needCursor","cursorTo","enter","enterMatches","enterCastFn","exit","more","readPath","__filterDotPath","dotPath","removeFirstDot","indexOf","substr","__filterBlockPath","blockPath","substring","test","parseInt","pathParam","path","push","stackCount","result","get","target","defaultValue","allget","name","hasOwnProperty","call","apply","Array","prototype","slice","arguments","hasProperty","hasValue","defaultObjectValueFunc","object","value","functionKeyObjectValueProc","functionKey","Boolean","selectKeyObjectValueProc","leftSelect","rightSelect","useLeftSelector","useRightSelector","obj","key","getKey","proc","i","l","objKey","readDown","rootValue","readFn","rootParam","enterScope","depth","param","arrayScope","objectScope","primitiveScope","array","type","childrenDepth","fill","v","Object","keys"],"mappings":"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","sourcesContent":["import {\n  isArray,\n  likeString,\n  isObject,\n  likeObject,\n  isNumber,\n  isEmpty\n} from './isLike'\n\nimport {\n  entries,\n  matchString\n} from './remark'\n\nimport {\n  all\n} from './enumerable'\n\nimport {\n  asArray\n} from './cast'\n\n\n//read.readString.spec.js\nexport const readString = (function (){\n  const rebaseMatches = matches=>entries(asArray(matches))\n  return function (text, matches, castFn, props){\n    const payload = {\n      content: text,\n      props\n    }\n  \n    const newMatchEntries = rebaseMatches(matches)\n  \n    const castingState = {\n      firstIndex  : 0,\n      lastIndex   : text.length,\n      castingStart: 0,\n      cursor      : 0\n    }\n    \n    if(typeof props === \"object\" && isNumber(props.start)){\n      castingState.castingStart = props.start\n      castingState.cursor = props.start\n    }\n\n    const open = function ({ castingState:{ firstIndex, lastIndex, castingStart, cursor }, matchEntries, castFn, parentScope }){\n      if(cursor >= lastIndex){\n        return false\n      }\n      \n      //find match\n      const matchesMap = matchEntries.map(([matchType, matchExp])=>([matchString(text, matchExp, cursor), matchType, matchExp]))\n      let firstMatch   = asArray(matchesMap).sort(([a, aPriority], [b, bPriority])=>(\n        a[0] < 0 ? true\n        : b[0] < 0 ? false\n        : a[0] == b[0] ? aPriority < bPriority : a[0] > b[0]\n      ))[0]\n      \n      // top match is not exsist\n      if(!firstMatch){ return false }\n      \n      // unmatched\n      if(firstMatch[0][0] === -1){\n        firstMatch = [[-1, 0], -1, null]\n      }\n\n      //next variant\n      const [[ matchIndex, matchSize ], matchType, matchExp] = firstMatch\n      const castStart = castingStart\n      const castEnd   = matchType === -1 ? lastIndex : (matchIndex + matchSize)\n      const castSize  = castEnd - castStart\n      const skipSize  = castSize - matchSize\n      \n      //next params\n      const matching = { \n        matchType, \n        matchExp,\n        matchIndex,\n        matchSize,\n        skipSize\n      }\n      const casting = {\n        firstIndex,\n        lastIndex,\n        castStart,\n        castEnd,\n        castSize\n      }\n      const scope = {\n        fork (matchEntries, castFn){\n          const newMatchEntries = rebaseMatches(matches)\n          open({\n            castingState: {\n              firstIndex  : matching.matchIndex,\n              lastIndex   : matching.matchIndex + matchSize,\n              castingStart: matching.matchIndex,\n              cursor      : matching.matchIndex\n            }, \n            matchEntries: newMatchEntries,\n            castFn,\n            parentScope\n          })\n        },\n        next (needCursor){\n          const cursorTo = isNumber(needCursor) ? needCursor : casting.castEnd\n          open({\n            castingState: {\n              firstIndex,\n              lastIndex,\n              castingStart: cursorTo,\n              cursor      : cursorTo\n            },\n            matchEntries,\n            castFn,\n            parentScope\n          })\n        },\n        enter (enterMatches, enterCastFn){\n          open({\n            castingState: {\n              firstIndex,\n              lastIndex,\n              castingStart: matching.matchIndex,\n              cursor      : matching.matchIndex\n            },\n            matchEntries: rebaseMatches(enterMatches),\n            castFn      : enterCastFn,\n            parentScope : {\n              next: scope.next\n            }\n          })\n        },\n        exit (needCursor){\n          parentScope && parentScope.next(isNumber(needCursor) ? needCursor : casting.castEnd)\n        },\n        more (){\n          open({\n            castingState: {\n              firstIndex,\n              lastIndex,\n              castingStart: castStart,\n              cursor      : casting.castEnd\n            },\n            matchEntries,\n            castFn,\n            parentScope\n          })\n        }\n      }\n      \n      castFn({\n        ...payload,\n        ...matching,\n        ...casting,\n        ...scope\n      })\n      \n      return true\n    }\n    \n    open({\n      castingState,\n      matchEntries: newMatchEntries,\n      castFn\n    })\n  \n    return payload\n  }\n}())\n\nexport const readPath = (function (){\n  const __filterDotPath = (dotPath, removeFirstDot)=>removeFirstDot && dotPath.indexOf(\".\") === 0 ? dotPath.substr(1) : dotPath\n  const __filterBlockPath = (blockPath)=>{\n    //remove []\n    blockPath = blockPath.substring(1, blockPath.length - 1)\n    \n    //interger\n    if(/^[0-9]+$/.test(blockPath)){\n      return parseInt(blockPath, 10)\n    }\n    \n    //remove ''\n    if(/^\\'.*\\'$/.test(blockPath) || /^\\\".*\\\"$/.test(blockPath)){\n      blockPath = blockPath.substring(1, blockPath.length - 1)\n    }\n    return blockPath\n  }\n\n  return function (pathParam){\n    if(isArray(pathParam)){\n      return pathParam\n    }\n  \n    if(likeString(pathParam)){\n      if(isNumber(pathParam)){\n        return [pathParam]\n      }\n    \n      if(typeof pathParam === \"string\"){\n        //one depth\n        if(!/\\.|\\[/.test(pathParam)){\n          return [pathParam]\n        }\n        \n        //multiple depth\n        const { props:{ path:result } } = readString(pathParam, [\".\", \"[\"], ({\n          content, props:{ path }, matchExp, castStart, castEnd, skipSize, enter, next\n        })=>{\n          if(matchExp === \".\"){\n            skipSize && path.push(content.substr(castStart, skipSize))\n            next()\n          }\n          if(matchExp === \"[\"){\n            let stackCount = 0\n          \n            if(skipSize){\n              path.push(__filterDotPath(content.substr(castStart, skipSize), castStart !== 0))\n            }\n          \n            enter([\"[\", \"]\"], ({ matchExp, castStart, castEnd, more, exit })=>{\n              if(matchExp === \"[\") stackCount++\n              if(matchExp === \"]\") stackCount--\n              if(matchExp === null) return\n              if(stackCount === 0){\n                path.push(__filterBlockPath(content.substring(castStart, castEnd)))\n                exit()\n              } else {\n                more()\n              }\n            })\n          }\n          if(matchExp === null){\n            path.push(__filterDotPath(content.substr(castStart, castEnd), castStart !== 0))\n          }\n        }, { path: [] })\n      \n        return result\n      }\n    }\n    return []\n  }\n}())\n\nexport const get = function (target, path, defaultValue){\n  if(typeof target === \"object\"){\n    switch (typeof path){\n      case \"number\": path += \"\"\n      case \"string\":\n        path = readPath(path)\n      case \"object\":\n        if(isArray(path)){\n          const allget = all(path, (name)=>{\n            if(likeObject(target) && (target.hasOwnProperty(name) || target[name])){\n              target = target[name]\n              return true\n            } else {\n              return false\n            }\n          })\n          return allget ? target : defaultValue\n        } else {\n          return\n        }\n        break\n      case \"function\": return path.call(this, target)\n    }\n  } else if(typeof target === \"function\"){\n    return target.apply(this, Array.prototype.slice.call(arguments, 1))\n  }\n  return target\n}\n\nexport const hasProperty = function (target, pathParam){\n  return all(readPath(pathParam), path=>{\n    if(likeObject(target) && likeString(path) && target.hasOwnProperty(path)){\n      target = target[path]\n      return true\n    }\n    return false\n  })\n}\n\nexport const hasValue = (function (){\n  const defaultObjectValueFunc = function (object, value){\n    return object === value\n  }\n    \n  const functionKeyObjectValueProc = function (functionKey){\n    return function (object, value){\n      return Boolean(functionKey(object, value))\n    }\n  }\n    \n  const selectKeyObjectValueProc = function (leftSelect, rightSelect){\n    var useLeftSelector  = (typeof leftSelect === \"string\" || typeof leftSelect === \"number\")\n    var useRightSelector = leftSelect === rightSelect ? useLeftSelector : (typeof rightSelect === \"string\" || typeof rightSelect === \"number\")\n        \n    return function (object, value){\n      if(useLeftSelector && !object.hasOwnProperty(leftSelect)) return false\n      if(useRightSelector && !value.hasOwnProperty(rightSelect)) return false\n            \n      return (useLeftSelector ? get(object, leftSelect) : object) === (useRightSelector ? get(value, rightSelect) : value)\n    }\n  }\n    \n  return function (obj, value, key, getKey){\n    if(typeof key === \"boolean\"){\n      if(typeof getKey !== \"boolean\"){\n        getKey = key\n      }\n      key = void 0\n    }\n        \n    if(obj === value){\n      return true\n    } else if(likeObject(obj)){\n      if(value === (void 0) && key === (void 0)) return !isEmpty(obj)\n            \n      var proc\n            \n      if(key){\n        if(typeof key === \"function\"){\n          proc = functionKeyObjectValueProc(key)\n        } else if(isArray(key) && key.length > 1){\n          proc = selectKeyObjectValueProc(key[0], key[1])\n        } else if(typeof key === \"string\" || typeof key === \"number\"){\n          proc = selectKeyObjectValueProc(key, key)\n        }\n      } else {\n        proc = defaultObjectValueFunc\n      }\n            \n      if(isArray(obj)){\n        for(var i = 0, l = obj.length; i < l; i++) if(proc(obj[i], value)) return getKey ? i : true\n      } else {\n        for(var objKey in obj) if(obj.hasOwnProperty(objKey) && proc(obj[objKey], value)) return getKey ? objKey : true \n      }\n    }\n        \n    return getKey ? void 0 : false\n  }\n}())\n\nexport const readDown = function (rootValue, readFn, rootParam){\n  const enterScope = (value, depth, param)=>isArray(value) ? arrayScope(value, depth, param) : isObject(value) ? objectScope(value, depth, param) : primitiveScope(value, depth, param)\n  \n  const arrayScope = (array, depth, param)=>{\n    return readFn({\n      type : \"array\",\n      value: array,\n      key  : null,\n      depth,\n      param,\n      enter: (param)=>{\n        const childrenDepth = depth + 1\n        return Array(array.length).fill(void 0).map((v, i)=>i).map(key=>{\n          const value = array[key]\n          return enterScope(value, childrenDepth, param)\n        })\n      }\n    })\n  }\n  \n  const objectScope = (object, depth, param)=>{\n    return readFn({\n      type : \"object\",\n      value: object,\n      key  : null,\n      depth,\n      param,\n      enter: (param)=>{\n        const childrenDepth = depth + 1\n        return Object.keys(object).map(key=>{\n          const value = object[key]\n          return readFn({\n            type : \"hash\",\n            key,\n            value,\n            depth,\n            param,\n            enter: (param)=>enterScope(value, childrenDepth, param)\n          })\n        })\n      }\n    })\n  }\n  \n  const primitiveScope = (value, depth, param)=>{\n    readFn({\n      type : \"value\",\n      key  : null,\n      value,\n      depth,\n      param,\n      enter: (param)=>param\n    })\n  }\n  \n  enterScope(rootValue, 0, rootParam)\n  return rootParam\n}\n"],"file":"read.js"}