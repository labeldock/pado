{"version":3,"sources":["../packages/pado/functions/datetime.js"],"names":["dateExp","dv","format","join","dt","exec","Date","getYear","getMonth","getDate","r","Object","defineProperties","year","enumerable","value","month","date","hour","minute","second","init","get","s","replace","timestampExp","exp","arguments","length","timescaleExp","scale","t","d"],"mappings":"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","sourcesContent":["import { isArray } from './isLike'\nimport { toNumber } from './cast'\n\nexport const dateExp = function (dv, format){\n  if(isArray(dv)) dv = dv.join(' ')\n\n  var dt = /(\\d\\d\\d\\d|)[^\\d]?(\\d\\d|\\d|).?(\\d\\d|\\d|)[^\\d]?(\\d\\d|\\d|)[^\\d]?(\\d\\d|\\d|)[^\\d]?(\\d\\d|\\d|)/.exec(dv)\n  dt[1] = dt[1] || (((new Date()).getYear() + 1900) + '')\n  dt[2] = dt[2] || ((new Date()).getMonth() + 1)\n  dt[3] = dt[3] || ((new Date()).getDate())\n  dt[4] = dt[4] || (\"00\")\n  dt[5] = dt[5] || (\"00\")\n  dt[6] = dt[6] || (\"00\")\n\n  var r = [ dt[1], dt[2], dt[3], dt[4], dt[5], dt[6], dt[0] ]\n  Object.defineProperties(r, {\n    year  : { enumerable: false, value: dt[1] },\n    month : { enumerable: false, value: dt[2] },\n    date  : { enumerable: false, value: dt[3] },\n    hour  : { enumerable: false, value: dt[4] },\n    minute: { enumerable: false, value: dt[5] },\n    second: { enumerable: false, value: dt[6] },\n    init  : { enumerable: false, value: dt[7] },\n    format: {\n      enumerable: false,\n      get       : ()=>function (s){\n        return s.replace('YYYY', r.year).replace(/(MM|M)/, r.month).replace(/(DD|D)/, r.date)\n        .replace(/(hh|h)/, r.hour).replace(/(mm|m)/, r.minute).replace(/(ss|s)/, r.second)\n        .replace(/(A)/, (toNumber(r.hour) > 12) ? 'PM' : 'AM')\n      }\n    }\n  })\n  if(typeof format === 'string'){ return r.format(format) }\n  return r\n}\n\nexport const timestampExp = function (exp){\n  if(arguments.length === 0){\n    return (+new Date())\n  }\n  if(typeof exp === \"string\"){\n    exp = dateExp(exp)\n  }\n  if(typeof exp === \"number\"){\n    return exp\n  }\n  if(isArray(exp) && (exp.length == 7)){\n    exp = new Date(exp[0], exp[1], exp[2], exp[3], exp[4], exp[5])\n  }\n  if(exp instanceof Date){\n    return (+exp)\n  }\n  return 0\n}\n\nexport const timescaleExp = function (exp){\n  var scale = 0\n  if(typeof exp === \"number\"){\n    return exp\n  }\n  if(typeof exp === \"string\"){\n    // \n    exp = exp.replace(/\\d+(Y|year)/, function (t){\n      t.replace(/\\d+/, function (d){ scale += d * 31536000000 })\n      return \"\"\n    })\n    exp = exp.replace(/\\d+(M|month)/, function (t){\n      t.replace(/\\d+/, function (d){ scale += d * 2678400000 })\n      return \"\"\n    })\n    exp = exp.replace(/\\d+(D|day)/, function (t){\n      t.replace(/\\d+/, function (d){ scale += d * 86400000 })\n      return \"\"\n    })\n    exp = exp.replace(/\\d+(h|hour)/, function (t){\n      t.replace(/\\d+/, function (d){ scale += d * 3600000 })\n      return \"\"\n    })\n    exp = exp.replace(/\\d+(ms|millisecond)/, function (t){\n      t.replace(/\\d+/, function (d){ scale += d * 1 })\n      return \"\"\n    })\n    exp = exp.replace(/\\d+(m|minute)/, function (t){\n      t.replace(/\\d+/, function (d){ scale += d * 60000 })\n      return \"\"\n    })\n    exp = exp.replace(/\\d+(s|second)/, function (t){\n      t.replace(/\\d+/, function (d){ scale += d * 1000 })\n      return \"\"\n    })\n  }\n  return scale\n}\n"],"file":"datetime.js"}