{"version":3,"sources":["../.src/src/functions/reducer.js"],"names":["findIndex","__find_string","it","search","at","indexOf","__find_regexp","i","substring","RegExp","findIndexes","c","s","idxs","mvc","next","length","push","cut","collection","cutLength","emptyDefault","undefined","data","fill","splice","Number","POSITIVE_INFINITY","dataLength","l","top","iteratee","topLength","a","b","NEGATIVE_INFINITY","sort","max","numberList","result","forEach","n","castString","text","matches","castFn","property","cursorStart","start","cursorEnd","end","cursor","open","map","castPath","pathParam","meta","matchType","match","casting","fork","nextIndex","skip","lead","feet","substr","get","target","path","eval","call","apply","Array","prototype","slice","arguments","hasProperty","hasOwnProperty","hasValueProperty","obj","value","key","turn","p","ts","abs","Math","floor"],"mappings":"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","sourcesContent":["import { \n  isArray,\n  isInfinity,\n  isNumber,\n  isEmpty,\n  likeRegexp,\n  likeString,\n  likeObject\n} from './isLike'\n\nimport {\n  asArray\n} from './cast'\n\nimport {\n  all\n} from './enumerator'\n\nimport _get from 'lodash/get';\n\n//reducer.spec.js\nexport const findIndex = (function(){\n  const __find_string = (it,search,at)=>it.indexOf(search,at);\n  const __find_regexp = (it,search,at)=>{\n    let i = it.substring(at || 0).search(search);\n    return (i >= 0) ? (i + (at || 0)) : i;\n  };\n  return (it,search,at)=>((search instanceof RegExp)?__find_regexp:__find_string)(it,search,at);\n}());\n\n//reducer.spec.js\nexport const findIndexes = (function(){\n  return function(c,s,at){\n      if(typeof c === \"string\" || typeof c === \"number\"){\n        var idxs=[], mvc=c+\"\", s=likeRegexp(s)?s:s+\"\", at=(!at || !isNumber(at) || at < 0)?0:at, next;\n        do {\n          let i = findIndex(c,s,at);\n          if(i > -1){\n            at = (s.length || 1) + i;\n            idxs.push(i); \n            next = true;\n          } else {\n            next = false;\n          }\n        } while(next)\n        return idxs;\n      }\n    }\n}());\n\nexport const cut = function(collection,cutLength=1,emptyDefault=undefined){\n  let data = asArray(collection);\n  let fill = emptyDefault;\n  \n  if(data.length > cutLength){\n    data.splice(cutLength,Number.POSITIVE_INFINITY);\n    return data;\n  }\n  \n  let dataLength = data.length;\n  \n  if(typeof emptyDefault !== \"function\"){\n    fill = ()=>emptyDefault;\n  }\n  \n  for(let i=0,l=cutLength-dataLength;i<l;i++){\n    data.push(fill( dataLength++, i ));\n  }\n  \n  return data;\n}\n\nexport const top = function(data,iteratee,topLength){\n  if(typeof iteratee !== \"function\"){\n    iteratee=(a,b)=>a<b;\n  }\n  \n  if(typeof topLength === \"boolean\"){\n    topLength = topLength ? Number.POSITIVE_INFINITY : Number.NEGATIVE_INFINITY;\n  }\n  \n  return isNumber(topLength) || isInfinity(topLength) ?\n  asArray(data).sort((a,b)=>iteratee(a,b)).splice(0,topLength):\n  asArray(data).sort((a,b)=>iteratee(a,b))[0];\n};\n\nexport const max = function(numberList){\n  let result;\n  asArray(numberList).forEach(n=>{\n    if(isNumber(n)){\n      if(typeof result !== \"number\"){\n        result = n;\n        return;\n      } \n      if(result < n){\n        result = n;\n      }\n    }\n  })\n  return result;\n};\n\n//\nexport const castString = function(text,matches,castFn,property){\n  let cursorStart = isNumber(property.start) && property.start > 0 ? property.start : 0;\n  let cursorEnd   = isNumber(property.end) ? property.end : text.length;\n  let cursor      = cursorStart;\n  \n  const open = function({ cursorStart, cursorEnd, cursor, matches }){\n    max(matches.map(matchExp=>{\n      findIndex()\n    }));\n  };\n  \n  open({\n    cursorStart,\n    cursorEnd,\n    cursor,\n    matches\n  })\n  \n  return property;\n};\n\nexport const castPath = function(pathParam){\n  if(isArray(pathParam)){\n    return pathParam;\n  }\n  if(likeString(pathParam)){\n    if(isNumber(pathParam)){\n      return [pathParam]\n    }\n    if(typeof pathParam === \"string\"){\n      const { meta:{ result } } = castString(pathParam,[\".\",\"[\"],({ property:{ meta }, matchType, match, casting, fork, nextIndex, next, skip })=>{\n        switch(matchType){\n        // \".\"\n        case 0:\n          meta.push(casting);\n          next(nextIndex);\n          break;\n        // \"]\"\n        case 1:\n          let [lead, feet] = [1, 0];\n          \n          fork([\"[\",\"]\"],({ matchType, match, casting, nextIndex , next, skip })=>{\n            matchType === 0 && lead++;\n            matchType === 1 && feet++;\n            \n            if(lead === feet){\n              meta.push(casting.substr(1))\n              next(nextIndex);\n            } else {\n              skip();\n            }\n          });\n          break;\n        //end\n        case -1:\n          meta.push(casting);\n          break;\n        default:\n          skip();\n          break;\n        }\n        skip();\n      },{meta:[]});\n      \n      return result;\n    }\n  }\n  return [];\n};\n\nexport const get = function(target,path){\n  if(typeof target === \"object\"){\n    switch(typeof path){\n      case \"number\": path += \"\";\n      case \"string\": return path.indexOf(\"[\") == 0 ? eval(\"target\"+path) : eval(\"target.\"+path);\n      case \"function\": return path.call(this,target);\n    }\n  } else if(typeof target === \"function\"){\n    return target.apply(this,Array.prototype.slice.call(arguments,1));\n  }\n  return target;\n}\n\nexport const hasProperty = function(target,pathParam){\n  return all(castPath(pathParam),path=>{\n    if(likeObject(target) && likeString(path) && target.hasOwnProperty(path)){\n      target = target[path];\n      return true;\n    }\n    return false;\n  });\n}\n\nexport const hasValueProperty = function(obj,value,key){\n  if(arguments.length == 1 && likeObject(obj)) return isEmpty(obj);\n  if(isArray(obj)) for(var i=0,l=obj.length;i<l;i++) if(obj[i] === value) return true;\n  if(likeObject(obj)){\n    if(key){\n      return _get(obj,key) === value;\n    } else {\n      for(var key in obj) if(_get(obj,key) === value) return true;\n    }\n  }\n  return false;\n};\n\nexport const turn = function(i, p, ts) {\n  if(i < 0) { var abs = Math.abs(i / ts); i = p - (abs > p ? abs % p : abs); }\n  ts = ts || 1; i = Math.floor(i / ts);\n  return (p > i) ? i : i % p;\n};"],"file":"reducer.js"}