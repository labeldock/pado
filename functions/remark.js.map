{"version":3,"sources":["../packages/pado/functions/remark.js"],"names":["fallback","value","fallbackFn","args","valueOf","keys","baseKeys","deepKeys","nestedDeepKeys","target","filter","scope","total","key","child","useKey","length","currentScope","push","result","entries","baseEntries","findIndex","__find_string","it","search","at","indexOf","__find_regexp","i","substring","RegExp","findIndexes","c","s","idxs","next","NESTED_HAS_PROC","obj","split","pointer","ki","k","hasOwnProperty","diffStructure","before","after","afterKeys","Object","beforeKeys","canDiff","analysis","concat","reduce","dest","undefined","match","missing","surplus","diff","pass","forEach"],"mappings":"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","sourcesContent":["import {\n  isNumber,\n  likeRegexp,\n  isObject,\n  isArray,\n  isEqual\n} from './isLike'\n\nimport {\n  get,\n  hasValue\n} from './read'\n\nimport {\n  clone,\n  unique,\n  asArray\n} from './cast'\n\nimport {\n  baseEntries,\n  baseKeys\n} from './baseFunction'\n\n\nexport const fallback = function (value, fallbackFn, ...args){\n  return typeof value === \"undefined\" ? fallbackFn(...args) : value\n}\n\nexport const valueOf = function (value, ...args){\n  return typeof value === \"function\" ? value(...args) : value\n}\n\nexport const keys = baseKeys\n\nexport const deepKeys = (function (){\n  const nestedDeepKeys = function (target, filter, scope, total){\n    if(typeof target === \"object\"){\n      keys(target, (key)=>{\n        const child  = target[key]\n        const useKey = filter(child, key, scope.length)\n        if(!useKey){\n          return\n        }\n        const currentScope = clone(scope)\n        currentScope.push(key)\n        total.push(currentScope)\n        nestedDeepKeys(child, filter, currentScope, total)\n      }, true)\n    }\n  }\n  \n  return function (target, filter){\n    const result = []\n    nestedDeepKeys(target, filter ? (child, key)=>{ filter(child, key) } : ()=>true, [], result)\n    return result\n  }\n}())\n\nexport const entries = baseEntries\n\nexport const findIndex = (function (){\n  const __find_string = (it, search, at)=>it.indexOf(search, at)\n  const __find_regexp = (it, search, at)=>{\n    let i = it.substring(at || 0).search(search)\n    return (i >= 0) ? (i + (at || 0)) : i\n  }\n  return (it, search, at)=>((search instanceof RegExp) ? __find_regexp : __find_string)(it, search, at)\n}())\n\n//remark.spec.js\nexport const findIndexes = (function (){\n  return function (c, s, at){\n    if(typeof c === \"string\" || typeof c === \"number\"){\n      var idxs = []; var s = likeRegexp(s) ? s : s + \"\"; var at = (!at || !isNumber(at) || at < 0) ? 0 : at; var next\n      do {\n        let i = findIndex(c, s, at)\n        if(i > -1){\n          at = (s.length || 1) + i\n          idxs.push(i) \n          next = true\n        } else {\n          next = false\n        }\n      } while(next)\n      return idxs\n    }\n  }\n}())\n\n\n//TODO: Union hasValue\nconst NESTED_HAS_PROC = function (obj, key){\n  var keys = key.split(\".\")\n  if(!keys.length) return false\n\n  var pointer = obj\n  for(var ki in keys){\n    var k = keys[ki]\n\n    if(!pointer.hasOwnProperty(k)){\n      return false\n    } else {\n      pointer = pointer[k]\n    }\n  }\n  return true\n}\n\nexport const diffStructure = function (before, after){\n  var afterKeys = Object.keys(after)\n  var beforeKeys\n  var canDiff = false\n  if(isObject(before)){\n    if(isArray(before)){\n      beforeKeys = before\n    } else {\n      beforeKeys = Object.keys(before)\n      canDiff = true\n    }\n  } else {\n    beforeKeys = []\n  }\n\n  var analysis = {\n    after  : after,\n    before : before,\n    keys   : unique(afterKeys.concat(beforeKeys)).reduce((dest, key)=>{ dest[key] = undefined; return dest }, {}),\n    match  : [],\n    missing: [],\n    surplus: [],\n    diff   : [],\n    pass   : false\n  }\n  \n  //match, missing\n  for(var ki in beforeKeys){\n    if(!beforeKeys.hasOwnProperty(ki)) continue\n      \n    var key = beforeKeys[ki]\n      \n    if(NESTED_HAS_PROC(after, key)){\n      analysis.match.push(key)\n      analysis.keys[key] = \"match\"\n\n      if(canDiff && !isEqual(get(after, key), get(before, key))){\n        analysis.diff.push(key)\n        analysis.keys[key] = \"diff\"\n      }\n    } else {\n      analysis.surplus.push(key)\n      analysis.keys[key] = \"surplus\"\n    }\n  }\n\n  //surplus\n  asArray(afterKeys).forEach(key=>{\n    if(!hasValue(analysis.match, key)){\n      analysis.missing.push(key)\n      analysis.keys[key] = \"missing\"\n    }\n  })\n\n  //absolute\n  analysis.pass = !analysis.missing.length && !analysis.surplus.length\n\n  return analysis\n}\n"],"file":"remark.js"}