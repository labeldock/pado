{"version":3,"sources":["../.src/src/functions/cast.js"],"names":["asArray","data","defaultArray","undefined","toArray","option","NaN","Array","prototype","slice","call","split","asObject","defaultKey","toNumber","v","d","r","replace","cleanObject","splice","length","Object","keys","forEach","key","entries","it","result","k","push","target","filterExp","filter","isNaN","parseInt","deepEntries","clone","i","Date","setTime","getTime","hasOwnProperty","console","error","cloneDeep","l","p","castString","text","matches","castFn","property","matchEntries","cursorState","cursorStart","cursor","start","isNumber","end","open","firstMatch","top","map","matchType","matchExp","findIndex","a","aPriority","b","bPriority","matchIndex","matchLength","nextIndex","endIndex","casting","startIndex","fork","next","skip","castPath","pathParam","likeString","meta","lead","feet","substr","free","datum","dest","test","_cloneDeep","getKeyWithValue","obj","value","removeValue","detect","array","instance","func","proto","ins","DummyInstance","param","alloc","init","fn","rn","args","apply","syncData","ENTER_HOOK","newDatum","_","assign","UPDATE_HOOK","oldDatum","oldData","newData","getId","options","Error","getIdString","get","e","hooks","oldDataMap","id","ref","newId","genDatum","dirty","oldOwnKeys","indexOf","newOwnKeys","isEqual","pick"],"mappings":";;;;;;;;;;;;;;;;;;;;AAUO,MAAMA,UAAU,SAAVA,OAAU,CAASC,IAAT,EAAeC,YAAf,EAAyC;AAAA,QAA1BA,YAA0B;AAA1BA,kBAA0B,GAAXC,SAAW;AAAA;;AAC9D,QAAG,qBAAQF,IAAR,CAAH,EAAkB;AAChB,aAAOA,IAAP;AACD;;AACD,QAAG,oBAAOA,IAAP,CAAH,EAAiB;AACf,aAAO,qBAAQC,YAAR,IAAwBA,YAAxB,GACH,oBAAOA,YAAP,IAAuB,EAAvB,GAA4B,CAACA,YAAD,CADhC;AAED;;AACD,QAAG,OAAOD,IAAP,KAAgB,QAAhB,IAA4B,OAAOA,KAAKG,OAAZ,KAAwB,UAAvD,EAAmE;AACjE,aAAOH,KAAKG,OAAL,EAAP;AACD;;AACD,WAAO,CAACH,IAAD,CAAP;AACD,GAZM;;;;AAcA,MAAMG,UAAU,SAAVA,OAAU,CAASH,IAAT,EAAcI,MAAd,EAAqB;AAC1C,QAAG,OAAOJ,IAAP,KAAgB,WAAhB,IAA+BA,SAAS,IAAxC,IAAgDA,SAASK,GAA5D,EAAkE,OAAO,EAAP;AAClE,QAAG,qBAAQL,IAAR,CAAH,EAAkB,OAAOM,MAAMC,SAAN,CAAgBC,KAAhB,CAAsBC,IAAtB,CAA2BT,IAA3B,CAAP;AAClB,QAAG,OAAOA,IAAP,KAAgB,QAAhB,IAA4B,OAAOA,KAAKG,OAAZ,KAAwB,UAAvD,EAAmE,OAAOH,KAAKG,OAAL,EAAP;AACnE,QAAG,OAAOH,IAAP,KAAgB,QAAhB,EAA0B,OAAOI,MAAP,KAAkB,QAA/C,EAAyD,OAAOJ,KAAKU,KAAL,CAAWN,MAAX,CAAP;AACzD,WAAO,CAACJ,IAAD,CAAP;AACD,GANM;;;;AAQA,MAAMW,WAAW,SAAXA,QAAW,CAASX,IAAT,EAAeY,UAAf,EAAuC;AAAA,QAAxBA,UAAwB;AAAxBA,gBAAwB,GAAX,SAAW;AAAA;;AAC7D,QAAG,2BAAcZ,IAAd,CAAH,EAAuB;AACrB,aAAOA,IAAP;AACD,KAFD,MAEO;AAAA;;AACL,6BAAUY,UAAV,IAAsBZ,IAAtB;AACD;AACF,GANM;;;;AAQA,MAAMa,WAAW,SAAXA,QAAW,CAASC,CAAT,EAAWC,CAAX,EAAa;AACnC,YAAO,OAAOD,CAAd;AAAkB,WAAK,QAAL;AAAc,eAAOA,CAAP;;AAAS,WAAK,QAAL;AAAc,YAAIE,IAAEF,EAAEG,OAAF,CAAU,WAAV,EAAsB,EAAtB,IAA0B,CAAhC;AAAkC,eAAO,2BAAcD,CAAd,IAAiB,CAAjB,GAAmBA,CAA1B;AAA4B;AAArH;;AACA,YAAO,OAAOD,CAAd;AAAkB,WAAK,QAAL;AAAc,eAAOA,CAAP;;AAAS,WAAK,QAAL;AAAc,YAAIC,IAAED,IAAE,CAAR;AAAU,eAAO,2BAAcC,CAAd,IAAiB,CAAjB,GAAmBA,CAA1B;AAA4B;AAA7F;;AACA,WAAO,CAAP;AACD,GAJM;;;;AAMA,MAAME,cAAc,SAAdA,WAAc,CAASlB,IAAT,EAAc;AACvC,QAAGA,gBAAgBM,KAAnB,EAAyB;AACvBA,YAAMC,SAAN,CAAgBY,MAAhB,CAAuBV,IAAvB,CAA4BT,IAA5B,EAAiC,CAAjC,EAAmCA,KAAKoB,MAAxC;AACD,KAFD,MAEO,IAAG,OAAOpB,IAAP,IAAe,QAAlB,EAA4B;AACjCqB,aAAOC,IAAP,CAAYtB,IAAZ,EAAkBuB,OAAlB,CAA0B,eAAK;AAAE,eAAOvB,KAAKwB,GAAL,CAAP;AAAkB,OAAnD;AACD;;AACD,WAAOxB,IAAP;AACD,GAPM;;;;AASA,MAAMyB,UAAU,SAAVA,OAAU,CAASC,EAAT,EAAY;AACjC,QAAIC,SAAS,EAAb;;AACA,YAAO,OAAOD,EAAd;AACA,WAAK,QAAL;AACE,4BAAOA,EAAP,IAAa,CAAb,GACA,uBAAUA,EAAV,IAAgB3B,QAAQ2B,EAAR,EAAYH,OAAZ,CAAoB,UAACT,CAAD,EAAGc,CAAH,EAAO;AAAED,iBAAOE,IAAP,CAAY,CAACD,CAAD,EAAGd,CAAH,CAAZ;AAAoB,SAAjD,CAAhB,GACAO,OAAOC,IAAP,CAAYI,EAAZ,EAAgBH,OAAhB,CAAwB,eAAK;AAAEI,iBAAOE,IAAP,CAAY,CAACL,GAAD,EAAME,GAAGF,GAAH,CAAN,CAAZ;AAA6B,SAA5D,CAFA;AAGA;AALF;;AAOA,WAAOG,MAAP;AACD,GAVM;;;;AAYA,MAAML,OAAO,SAAPA,IAAO,CAASQ,MAAT,EAAgBC,SAAhB,EAA0B;AAC5C,QAAIJ,SAAS,EAAb;AACA,QAAIK,SAAS,OAAOD,SAAP,KAAqB,UAArB,GAAkCA,SAAlC,GAA8C;AAAA,aAAI,IAAJ;AAAA,KAA3D;AAEA,2BAAUD,MAAV,KAAqBT,OAAOC,IAAP,CAAYQ,MAAZ,EAAoBE,MAApB,CAA2B,eAAK;AACnD,OAACC,MAAMT,GAAN,CAAD,IAAeQ,OAAOR,GAAP,EAAWM,MAAX,CAAf,IAAqCH,OAAOE,IAAP,CAAYK,SAASV,GAAT,EAAa,EAAb,CAAZ,CAArC;AACD,KAFoB,CAArB,IAEM,wBAAWM,MAAX,KAAsBT,OAAOC,IAAP,CAAYQ,MAAZ,EAAoBP,OAApB,CAA4B,eAAK;AAC3DS,aAAOR,GAAP,EAAWM,MAAX,KAAsBH,OAAOE,IAAP,CAAYL,GAAZ,CAAtB;AACD,KAF2B,CAF5B;AAMA,WAAOG,MAAP;AACD,GAXM;;;;AAaA,MAAMQ,cAAc,SAAdA,WAAc,CAASL,MAAT,EAAgBE,MAAhB,EAAuB;AAChD,QAAG,uBAAUF,MAAV,CAAH,EAAqB,CAEpB;;AACD,QAAG,wBAAWA,MAAX,CAAH,EAAsB,CAErB;AACF,GAPM;;;;AASA,MAAMM,QAAQ,SAARA,KAAQ,CAASN,MAAT,EAAgB;AACnC,YAAO,OAAOA,MAAd;AACA,WAAK,WAAL;AAAkB,WAAK,UAAL;AAAiB,WAAK,SAAL;AAAgB,WAAK,QAAL;AAAe,WAAK,QAAL;AAAe,eAAOA,MAAP;AAAe;;AAChG,WAAK,QAAL;AACE,YAAGA,WAAW,IAAd,EAAoB,OAAOA,MAAP;;AAEpB,YAAG,qBAAQA,MAAR,CAAH,EAAmB;AACjB,cAAId,KAAE,EAAN;;AACA,eAAI,IAAIqB,IAAE,CAAN,EAAQjB,SAAOU,OAAOV,MAA1B,EAAiCiB,IAAEjB,MAAnC,EAA0CiB,GAA1C;AAA8CrB,eAAEa,IAAF,CAAOC,OAAOO,CAAP,CAAP;AAA9C;;AACA,iBAAOrB,EAAP;AACD;;AAED,YAAG,CAAC,2BAAcc,MAAd,CAAJ,EAA0B;AACxB,cAAGA,kBAAkBQ,IAArB,EAA0B;AACxB,gBAAItB,MAAE,IAAIsB,IAAJ,EAAN;;AACAtB,gBAAEuB,OAAF,CAAUT,OAAOU,OAAP,EAAV;;AACA,mBAAOxB,GAAP;AACD;;AACD,iBAAOc,MAAP;AACD;;AAED,YAAId,IAAE,EAAN;AACAK,eAAOC,IAAP,CAAYQ,MAAZ,EAAoBP,OAApB,CAA4B,aAAG;AAC7B,cAAGO,OAAOW,cAAP,CAAsBb,CAAtB,CAAH,EAA6BZ,EAAEY,CAAF,IAAKE,OAAOF,CAAP,CAAL;AAC9B,SAFD;AAGA,eAAOZ,CAAP;AACA;;AACF;AACE0B,gBAAQC,KAAR,CAAc,iCAAd,EAAgDb,MAAhD;AACA,eAAOA,MAAP;AACA;AA7BF;AA+BD,GAhCM;;;;AAkCA,MAAMc,YAAY,SAAZA,SAAY,CAASd,MAAT,EAAgB;AACvC,QAAIf,CAAJ;;AACA,QAAG,OAAOe,MAAP,KAAkB,QAArB,EAA8B;AAC7B,UAAG,qBAAQA,MAAR,CAAH,EAAoB;AACnB,YAAG,CAAC,qBAAQf,CAAR,CAAJ,EAAgB;AAAEA,cAAI,EAAJ;AAAQ;;AAAA;;AAC1B,aAAK,IAAIsB,IAAE,CAAN,EAAQQ,IAAEf,OAAOV,MAAtB,EAA6BiB,IAAEQ,CAA/B,EAAiCR,GAAjC;AAAsCtB,YAAEc,IAAF,CAAU,OAAOC,OAAOO,CAAP,CAAP,KAAqB,QAArB,IAAiCP,OAAOO,CAAP,MAAc,IAAhD,GAAyDD,MAAMN,OAAOO,CAAP,CAAN,CAAzD,GAA4EP,OAAOO,CAAP,CAArF;AAAtC;;AACA,eAAOtB,CAAP;AACA,OAJD,MAIO;AACNA,YAAI,EAAJ;AACEM,eAAOC,IAAP,CAAYQ,MAAZ,EAAoBP,OAApB,CAA4B,aAAG;AAC5B,iBAAOO,OAAOgB,CAAP,CAAP,KAAqB,QAArB,IAAiChB,OAAOgB,CAAP,MAAc,IAA/C,IAAuD/B,EAAE+B,CAAF,CAAxD,GAAgEV,MAAMN,OAAOgB,CAAP,CAAN,EAAgB/B,EAAE+B,CAAF,CAAhB,CAAhE,GAAwF/B,EAAE+B,CAAF,IAAOhB,OAAOgB,CAAP,CAA/F;AACD,SAFD;AAGF,eAAO/B,CAAP;AACA;AACD,KAZD,MAYO;AACLqB,YAAMN,MAAN;AACD;AACF,GAjBM,C,CAmBP;;;;;AACO,MAAMiB,aAAa,SAAbA,UAAa,CAASC,IAAT,EAAcC,OAAd,EAAsBC,MAAtB,EAA6BC,QAA7B,EAAsC;AAE9D,QAAIC,eAAc3B,QAAQ1B,QAAQkD,OAAR,CAAR,CAAlB;AAEA,QAAII,cAAc;AAChBC,mBAAYpD,SADI;AAEhBqD,cAAOrD;AAFS,KAAlB;AAKAmD,gBAAYG,KAAZ,GAAoBC,SAASN,SAASK,KAAlB,KAA4BL,SAASK,KAAT,GAAiB,CAA7C,GAAiDL,SAASK,KAA1D,GAAkE,CAAtF;AACAF,gBAAYI,GAAZ,GAAoBD,SAASN,SAASO,GAAlB,IAAyBP,SAASO,GAAlC,GAAwCV,KAAK5B,MAAjE;AACAkC,gBAAYC,MAAZ,GAAoBF,YAAYG,KAAhC;;AAEA,QAAMG,OAAO,SAAPA,IAAO,QAA+D;AAAA,oCAApDN,WAAoD;AAAA,UAAtCC,WAAsC,qBAAtCA,WAAsC;AAAA,UAAzBC,MAAyB,qBAAzBA,MAAyB;AAAA,UAAfH,YAAe,SAAfA,YAAe;AAC1E,UAAMQ,aAAaC,IACjBT,aAAaU,GAAb,CAAiB;AAAA,YAAEC,SAAF;AAAA,YAAaC,QAAb;AAAA,eAAyB,CAACC,UAAUjB,IAAV,EAAegB,QAAf,CAAD,EAA2BD,SAA3B,EAAsCC,QAAtC,CAAzB;AAAA,OAAjB,CADiB,EAEjB;AAAA,YAAEE,CAAF;AAAA,YAAIC,SAAJ;AAAA,YAAgBC,CAAhB;AAAA,YAAkBC,SAAlB;AAAA,eAA+BH,KAAGE,CAAH,GAAKD,YAAUE,SAAf,GAAyBH,IAAEE,CAA1D;AAAA,OAFiB,CAAnB;;AAIA,UAAG,CAACR,UAAJ,EAAe;AAAE;AAAQ;;AALiD,UAOnEU,UAPmE,GAOnBV,UAPmB;AAAA,UAOvDG,SAPuD,GAOnBH,UAPmB;AAAA,UAO5CI,QAP4C,GAOnBJ,UAPmB;AAAA,UAOlCW,WAPkC,GAOnBX,UAPmB;;AAQ1E,UAAGU,eAAa,CAAC,CAAjB,EAAmB;AAAE;AAAQ;;AAE7B,UAAME,YAAYF,aAAW,CAA7B;AACA,UAAMG,WAAYH,aAAWC,WAA7B;AAEArB,aAAO;AACLa,4BADK;AAELC,0BAFK;AAGLU,iBAAQ;AACNC,sBAAWrB,WADL;AAENmB,oBAASH,aAAWC,WAFd;AAGND,gCAHM;AAINE;AAJM,SAHH;AASLI,YATK,kBASE,CAEN,CAXI;AAYLC,YAZK,kBAYE,CAEN,CAdI;AAeLC,YAfK,kBAeE;AACLnB,eAAK;AAACN,yBAAY;AAACC,2BAAYqB,UAAb;AAAyBpB,sBAAOkB;AAAhC,aAAb;AAAwDrB;AAAxD,WAAL;AACD;AAjBI,OAAP;AAmBD,KAhCD;;AAkCAO,SAAK;AAAEN,8BAAF;AAAeD;AAAf,KAAL;AAED,GAjDM;;;;AAmDA,MAAM2B,WAAW,SAAXA,QAAW,CAASC,SAAT,EAAmB;AACzC,QAAG,qBAAQA,SAAR,CAAH,EAAsB;AACpB,aAAOA,SAAP;AACD;;AACD,QAAGC,WAAWD,SAAX,CAAH,EAAyB;AACvB,UAAGvB,SAASuB,SAAT,CAAH,EAAuB;AACrB,eAAO,CAACA,SAAD,CAAP;AACD;;AACD,UAAG,OAAOA,SAAP,KAAqB,QAAxB,EAAiC;AAAA,0BACHjC,WAAWiC,SAAX,EAAqB,CAAC,GAAD,EAAK,GAAL,CAArB,EAA+B,iBAA6E;AAAA,cAA1EjB,SAA0E,SAA1EA,SAA0E;AAAA,cAApDmB,IAAoD,SAA/D/B,QAA+D,CAApD+B,IAAoD;AAAA,cAAlCV,SAAkC,SAA5CE,OAA4C,CAAlCF,SAAkC;AAAA,cAArBI,IAAqB,SAArBA,IAAqB;AAAA,cAAfC,IAAe,SAAfA,IAAe;AAAA,cAATC,IAAS,SAATA,IAAS;;AACtI;AACA;AAEA,kBAAOf,SAAP;AACA;AACA,iBAAK,CAAL;AACEmB,mBAAKrD,IAAL,CAAU6C,OAAV;AACAG,mBAAKL,SAAL;AACA;AACF;;AACA,iBAAK,CAAL;AAAA,kBACOW,IADP,GACsB,CADtB;AAAA,kBACaC,IADb,GACyB,CADzB;AAGER,mBAAK,CAAC,GAAD,EAAK,GAAL,CAAL,EAAe,iBAAkD;AAAA,oBAA/Cb,SAA+C,SAA/CA,SAA+C;AAAA,oBAApCW,OAAoC,SAApCA,OAAoC;AAAA,oBAA3BF,SAA2B,SAA3BA,SAA2B;AAAA,oBAAfK,IAAe,SAAfA,IAAe;AAAA,oBAATC,IAAS,SAATA,IAAS;AAC/Df,8BAAc,CAAd,IAAmBoB,MAAnB;AACApB,8BAAc,CAAd,IAAmBqB,MAAnB;;AAEA,oBAAGD,SAASC,IAAZ,EAAiB;AACfF,uBAAKrD,IAAL,CAAU6C,QAAQW,MAAR,CAAe,CAAf,CAAV;AACAR,uBAAKL,SAAL;AACD,iBAHD,MAGO;AACLM;AACD;AACF,eAVD;AAWA;AACF;;AACA,iBAAK,CAAC,CAAN;AACEI,mBAAKrD,IAAL,CAAU6C,OAAV;AACA;;AACF;AACEI;AACA;AA5BF;;AA8BAA;AACD,SAnC2B,EAmC1B;AAACI,gBAAK;AAAN,SAnC0B,CADG;AAAA,YAChBvD,MADgB,eACvBuD,IADuB,CAChBvD,MADgB;;AAsC/B,eAAOA,MAAP;AACD;AACF;;AACD,WAAO,EAAP;AACD,GAlDM;;;;AAqDA,MAAM2D,OAAO,SAAPA,IAAO,CAASC,KAAT,EAAe;AACjC,QAAMC,OAAO,EAAb;AACAnE,WAAOC,IAAP,CAAYiE,KAAZ,EAAmBhE,OAAnB,CAA2B,eAAK;AAC9B,UAAG,CAAC,MAAMkE,IAAN,CAAWjE,GAAX,CAAJ,EAAoB;AAClBgE,aAAKhE,GAAL,IAAYkE,WAAWH,MAAM/D,GAAN,CAAX,CAAZ;AACD;AACF,KAJD;AAKA,WAAOgE,IAAP;AACD,GARM;;;;AAUP,MAAMG,kBAAkB,SAAlBA,eAAkB,CAASC,GAAT,EAAaC,KAAb,EAAmB;AACzC,QAAG,qBAAQD,GAAR,CAAH,EAAgB;AACd,WAAI,IAAIvD,IAAE,CAAN,EAAQQ,IAAE+C,IAAIxE,MAAlB,EAAyBiB,IAAEQ,CAA3B,EAA6BR,GAA7B;AAAkC,YAAGuD,IAAIvD,CAAJ,MAASwD,KAAZ,EAAmB,OAAOxD,CAAP;AAArD;AACD;;AACD,QAAG,sBAASuD,GAAT,CAAH,EAAiB;AACf,WAAI,IAAIpE,GAAR,IAAeoE,GAAf;AAAoB,YAAGA,IAAIpE,GAAJ,MAAWqE,KAAd,EAAqB,OAAOrE,GAAP;AAAzC;AACD;;AACD,WAAOtB,SAAP;AACD,GARD;;AAUO,MAAM4F,cAAc,SAAdA,WAAc,CAASF,GAAT,EAAaC,KAAb,EAAmB;AAC5C,QAAIE,SAAS,IAAb;AACA,QAAIC,QAAS,qBAAQJ,GAAR,CAAb;;AAEA,WAAMG,MAAN,EAAc;AACZ,UAAIvE,MAAMmE,gBAAgBC,GAAhB,EAAoBC,KAApB,CAAV;;AACA,UAAG,OAAOrE,GAAP,KAAe,WAAlB,EAA8B;AAC5BuE,iBAAS,KAAT;AACD,OAFD,MAEO;AACL,YAAGC,KAAH,EAAS;AACPJ,cAAIzE,MAAJ,CAAWK,GAAX,EAAe,CAAf;AACD,SAFD,MAEO;AACL,iBAAOoE,IAAIpE,GAAJ,CAAP;AACD;AACF;AACF;;AAED,WAAOoE,GAAP;AACD,GAlBM;;;;AAoBA,MAAMK,WAAW,SAAXA,QAAW,CAASC,IAAT,EAAcC,KAAd,EAAoB;AAC1C,QAAIC,GAAJ;AAAA,QAAQC,gBAAc,SAAdA,aAAc,CAASC,KAAT,EAAe;AAAE,UAAG,OAAOA,KAAP,KAAiB,QAApB,EAA8B,KAAI,IAAI1E,CAAR,IAAa0E,KAAb;AAAoB,aAAK1E,CAAL,IAAU0E,MAAM1E,CAAN,CAAV;AAApB;AAAyC,KAA9G;;AACA,QAAG,OAAOsE,IAAP,IAAe,QAAlB,EAA2B;AACzB,UAAG,OAAOC,KAAP,KAAiB,QAApB,EAA8BE,cAAc9F,SAAd,GAA0B4F,KAA1B;AAC9BC,YAAM,IAAIC,aAAJ,CAAkBH,IAAlB,CAAN;AACD;;AACD,QAAG,OAAOA,IAAP,IAAe,UAAlB,EAA6B;AAC3B,UAAG,OAAOC,KAAP,KAAiB,QAApB,EAA8BD,KAAK3F,SAAL,GAAiB4F,KAAjB;AAC9BC,YAAO,IAAIF,IAAJ,EAAP;AACD;;AACD,WAAOE,GAAP;AACD,GAXM;;;;AAaA,MAAMG,QAAQ,SAARA,KAAQ,CAASC,IAAT,EAAe;AAClC,QAAIC,KAAKD,MAAT;;AACA,QAAME,KAAK,SAALA,EAAK,GAAkB;AAAA,wCAANC,IAAM;AAANA,YAAM;AAAA;;AAC3B,aAAOF,GAAGG,KAAH,CAAS,IAAT,EAAeD,IAAf,CAAP;AACD,KAFD;;AAGAD,OAAG,OAAH,IAAc,YAAW;AAAED,WAAKD,KAAKE,EAAL,EAASA,EAAT,CAAL;AAAoB,KAA/C;;AACAA,OAAG,cAAH,IAAqBD,EAArB;AACA,WAAOC,EAAP;AACD,GARM;;;;AAUP,MAAMG,WAAY,YAAU;AAC1B,QAAMC,aAAc,SAAdA,UAAc,CAACC,QAAD;AAAA,aAAYC,EAAEC,MAAF,CAAS,EAAT,EAAaF,QAAb,CAAZ;AAAA,KAApB;;AACA,QAAMG,cAAc,SAAdA,WAAc,CAACC,QAAD,EAAWJ,QAAX;AAAA,aAAsBC,EAAEC,MAAF,CAAS,EAAT,EAAaE,QAAb,EAAuBJ,QAAvB,CAAtB;AAAA,KAApB;;AAEA,WAAO,UAASK,OAAT,EAAkBC,OAAlB,EAA2BC,KAA3B,EAAkCC,OAAlC,EAA2C;AAChD,UAAG,CAAC,kBAAkB9B,IAAlB,CAAuB,OAAO6B,KAA9B,CAAJ,EAA0C,MAAM,IAAIE,KAAJ,CAAU,qBAAV,CAAN;;AAE1C,UAAG,OAAOF,KAAP,KAAiB,QAApB,EAA8B;AAC5B,YAAMG,cAAcH,KAApB;;AACAA,gBAAQ;AAAA,iBAAGN,EAAEU,GAAF,CAAMC,CAAN,EAASF,WAAT,CAAH;AAAA,SAAR;AACD;;AAEDL,gBAAUrH,QAAQqH,OAAR,CAAV;AACAC,gBAAUtH,QAAQsH,OAAR,CAAV;AAEA,UAAM1F,SAAS,EAAf;AACA,UAAMiG,QAASjH,SAAS4G,OAAT,EAAiB,WAAjB,CAAf;;AAEA,UAAG,OAAOK,MAAM,OAAN,CAAP,KAA0B,UAA7B,EAAwC;AACtCA,cAAM,OAAN,IAAiBd,UAAjB;AACD;;AAED,UAAG,OAAOc,MAAM,QAAN,CAAP,KAA2B,UAA9B,EAAyC;AACvCA,cAAM,QAAN,IAAkBV,WAAlB;AACD;;AAED,UAAMW,aAAab,EAAElD,GAAF,CAAMsD,OAAN,EAAe,aAAG;AACnC,eAAO;AAAEU,cAAIR,MAAMK,CAAN,CAAN;AAAgBI,eAAKJ;AAArB,SAAP;AACD,OAFkB,CAAnB;;AAKA5H,cAAQsH,OAAR,EAAiB9F,OAAjB,CAAyB,UAACwF,QAAD,EAAW1E,CAAX,EAAe;AACtC,YAAM2F,QAAQV,MAAMP,QAAN,CAAd;;AACA,YAAII,WAAWH,EAAEU,GAAF,CAAMG,WAAWb,EAAE/C,SAAF,CAAY4D,UAAZ,EAAwB;AAAA,iBAAGF,EAAEG,EAAF,KAASE,KAAZ;AAAA,SAAxB,CAAX,CAAN,EAA8D,KAA9D,CAAf;;AACA,YAAIC,QAAJ;AACA,YAAIC,QAAQ,KAAZ;;AAEA,YAAGf,QAAH,EAAa;AACX;AACA,cAAG,OAAOA,QAAP,KAAoB,OAAOJ,QAA9B,EAAwC;AACtCmB,oBAAQ,KAAR;AACD,WAFD,MAEO;AAAE;AACP,gBAAMC,aAAa9G,OAAOC,IAAP,CAAY6F,QAAZ,EAAsBnF,MAAtB,CAA6B;AAAA,qBAAK,EAAER,IAAI4G,OAAJ,CAAY,GAAZ,MAAqB,CAAvB,CAAL;AAAA,aAA7B,CAAnB;AACA,gBAAMC,aAAahH,OAAOC,IAAP,CAAYyF,QAAZ,EAAsB/E,MAAtB,CAA6B;AAAA,qBAAK,EAAER,IAAI4G,OAAJ,CAAY,GAAZ,MAAqB,CAAvB,CAAL;AAAA,aAA7B,CAAnB,CAFK,CAIL;;AACA,gBAAGpB,EAAEsB,OAAF,CAAUH,UAAV,EAAsBE,UAAtB,CAAH,EAAsC;AACpCH,sBAAQ,CAAClB,EAAEsB,OAAF,CAAUtB,EAAEuB,IAAF,CAAOpB,QAAP,EAAiBgB,UAAjB,CAAV,EAAwCnB,EAAEuB,IAAF,CAAOxB,QAAP,EAAiBsB,UAAjB,CAAxC,CAAT;AACD,aAFD,MAEO;AACLH,sBAAQ,IAAR;AACD;AACF;;AAED,cAAG,OAAON,MAAM,cAAN,CAAP,KAAiC,UAApC,EAA+C;AAC7C,gBAAGA,MAAM,cAAN,EAAsBT,QAAtB,EAAgCJ,QAAhC,MAA8C,KAAjD,EAAuD;AACrD;AACD;AACF;;AAEDkB,qBAAWL,MAAM,QAAN,EAAgBT,QAAhB,EAA0BJ,QAA1B,CAAX;;AAEA,cAAG,OAAOa,MAAM,aAAN,CAAP,KAAgC,UAAnC,EAA8C;AAC5CK,uBAAWL,MAAM,aAAN,EAAqBK,QAArB,EAA+Bd,QAA/B,EAAyCJ,QAAzC,CAAX;AACD;AACF,SA3BD,MA2BO;AACL,cAAG,OAAOa,MAAM,aAAN,CAAP,KAAgC,UAAnC,EAA8C;AAC5C,gBAAGA,MAAM,aAAN,EAAqBb,QAArB,MAAmC,KAAtC,EAA4C;AAC1C;AACD;AACF;;AAEDkB,qBAAWL,MAAM,OAAN,EAAeb,QAAf,CAAX;;AAEA,cAAG,OAAOa,MAAM,YAAN,CAAP,KAA+B,UAAlC,EAA6C;AAC3CK,uBAAWL,MAAM,YAAN,EAAoBK,QAApB,EAA8BlB,QAA9B,CAAX;AACD;AACF;;AAED,YAAG,OAAOa,MAAM,WAAN,CAAP,KAA8B,UAAjC,EAA6C;AAC3CA,gBAAM,WAAN,EAAmBK,QAAnB,EAA6B5F,CAA7B,EAAgC6F,KAAhC;AACD;;AAEDvG,eAAOE,IAAP,CAAYoG,QAAZ;AACD,OApDD;AAsDA,aAAOtG,MAAP;AACD,KAlFD;AAmFD,GAvFiB,EAAlB","sourcesContent":["import {\n  isArray,\n  likeArray,\n  likeObject,\n  isNone,\n  isAbsoluteNaN,\n  isPlainObject,\n  isObject\n} from './isLike'\n\nexport const asArray = function(data, defaultArray = undefined) {\n  if(isArray(data)) {\n    return data;\n  }\n  if(isNone(data)) {\n    return isArray(defaultArray) ? defaultArray\n      : isNone(defaultArray) ? [] : [defaultArray];\n  }\n  if(typeof data === \"object\" && typeof data.toArray === \"function\") {\n    return data.toArray();\n  }\n  return [data];\n};\n\nexport const toArray = function(data,option){\n  if(typeof data === \"undefined\" || data === null || data === NaN ) return [];\n  if(isArray(data)) return Array.prototype.slice.call(data);\n  if(typeof data === \"object\" && typeof data.toArray === \"function\") return data.toArray();\n  if(typeof data === \"string\", typeof option === \"string\") return data.split(option);\n  return [data];\n}\n\nexport const asObject = function(data, defaultKey = \"default\") {\n  if(isPlainObject(data)){\n    return data;\n  } else {\n    return { [defaultKey]:data }\n  }\n};\n\nexport const toNumber = function(v,d){\n  switch(typeof v){ case \"number\":return v;case \"string\":var r=v.replace(/[^.\\d\\-]/g,\"\")*1;return isAbsoluteNaN(r)?0:r;break; }\n  switch(typeof d){ case \"number\":return d;case \"string\":var r=d*1;return isAbsoluteNaN(r)?0:r;break; }\n  return 0;\n}\n\nexport const cleanObject = function(data){\n  if(data instanceof Array){\n    Array.prototype.splice.call(data,0,data.length)\n  } else if(typeof data == \"object\") {\n    Object.keys(data).forEach(key=>{ delete data[key] })\n  }\n  return data\n}\n\nexport const entries = function(it){\n  let result = [];\n  switch(typeof it){\n  case \"object\":\n    isNone(it) ? 0 :\n    likeArray(it) ? asArray(it).forEach((v,k)=>{ result.push([k,v]) }) :\n    Object.keys(it).forEach(key=>{ result.push([key, it[key]]) });\n    break;\n  }\n  return result;\n}\n\nexport const keys = function(target,filterExp){\n  let result = [];\n  let filter = typeof filterExp === \"function\" ? filterExp : ()=>true;\n  \n  likeArray(target) && Object.keys(target).filter(key=>{\n    !isNaN(key) && filter(key,target) && result.push(parseInt(key,10));\n  }) || likeObject(target) && Object.keys(target).forEach(key=>{\n    filter(key,target) && result.push(key);\n  });\n  \n  return result;\n};\n\nexport const deepEntries = function(target,filter){\n  if(likeArray(target)){\n    \n  }\n  if(likeObject(target)){\n    \n  }\n}\n\nexport const clone = function(target){\n  switch(typeof target){\n  case \"undefined\": case \"function\": case \"boolean\": case \"number\": case \"string\": return target; break;\n  case \"object\":\n    if(target === null) return target;\n    \n    if(isArray(target)){\n      let r=[];\n      for(let i=0,length=target.length;i<length;i++)r.push(target[i]);\n      return r;\n    }\n    \n    if(!isPlainObject(target)){\n      if(target instanceof Date){\n        let r=new Date();\n        r.setTime(target.getTime());\n        return r;\n      }\n      return target;\n    }\n    \n    let r={};\n    Object.keys(target).forEach(k=>{\n      if(target.hasOwnProperty(k)) r[k]=target[k];\n    })\n    return r;\n    break;\n  default : \n    console.error(\"clone::copy failed : target => \",target);\n    return target; \n    break\n  }\n}\n\nexport const cloneDeep = function(target){\n  var d;\n  if(typeof target === \"object\"){\n  \tif(isArray(target)) {\n  \t\tif(!isArray(d)) { d = [] };\n  \t\tfor (var i=0,l=target.length;i<l;i++) d.push( ((typeof target[i] === \"object\" && target[i] !== null ) ? clone(target[i]) : target[i]) )\n  \t\treturn d;\n  \t} else {\n  \t\td = {}\n      Object.keys(target).forEach(p=>{\n        (typeof target[p] === \"object\" && target[p] !== null && d[p]) ? clone(target[p],d[p]) : d[p] = target[p];\n      })\n  \t\treturn d;\n  \t}\n  } else {\n    clone(target);\n  }\n};\n\n//reducer.spec.js\nexport const castString = function(text,matches,castFn,property){\n\n  let matchEntries= entries(asArray(matches));\n  \n  let cursorState = {\n    cursorStart:undefined,\n    cursor:undefined\n  };\n  \n  cursorState.start = isNumber(property.start) && property.start > 0 ? property.start : 0;\n  cursorStart.end   = isNumber(property.end) ? property.end : text.length;\n  cursorStart.cursor= cursorState.start;\n  \n  const open = function({ cursorState:{ cursorStart, cursor }, matchEntries }){\n    const firstMatch = top(\n      matchEntries.map(([matchType, matchExp])=>[findIndex(text,matchExp), matchType, matchExp]),\n      ([a,aPriority],[b,bPriority])=>a==b?aPriority<bPriority:a<b\n    );\n    if(!firstMatch){ return }\n    \n    const [matchIndex, matchType, matchExp, matchLength] = firstMatch;\n    if(matchIndex===-1){ return }\n    \n    const nextIndex = matchIndex+1;\n    const endIndex  = matchIndex+matchLength;\n    \n    castFn({\n      matchType, \n      matchExp,\n      casting:{\n        startIndex:cursorStart,\n        endIndex:matchIndex+matchLength,\n        matchIndex,\n        nextIndex\n      },\n      fork (){\n        \n      },\n      next (){\n        \n      },\n      skip (){\n        open({cursorState:{cursorStart:startIndex, cursor:endIndex}, matchEntries});\n      }\n    })\n  };\n  \n  open({ cursorState, matchEntries });\n  \n};\n\nexport const castPath = function(pathParam){\n  if(isArray(pathParam)){\n    return pathParam;\n  }\n  if(likeString(pathParam)){\n    if(isNumber(pathParam)){\n      return [pathParam]\n    }\n    if(typeof pathParam === \"string\"){\n      const { meta:{ result } } = castString(pathParam,[\".\",\"[\"],({ matchType, property:{ meta }, casting:{ nextIndex }, fork, next, skip })=>{\n        //dpre\n        //const casting;\n        \n        switch(matchType){\n        // \".\"\n        case 0:\n          meta.push(casting);\n          next(nextIndex);\n          break;\n        // \"]\"\n        case 1:\n          let [lead, feet] = [1, 0];\n          \n          fork([\"[\",\"]\"],({ matchType, casting, nextIndex , next, skip })=>{\n            matchType === 0 && lead++;\n            matchType === 1 && feet++;\n            \n            if(lead === feet){\n              meta.push(casting.substr(1))\n              next(nextIndex);\n            } else {\n              skip();\n            }\n          });\n          break;\n        //end\n        case -1:\n          meta.push(casting);\n          break;\n        default:\n          skip();\n          break;\n        }\n        skip();\n      },{meta:[]});\n      \n      return result;\n    }\n  }\n  return [];\n};\n  \n\nexport const free = function(datum){\n  const dest = {}\n  Object.keys(datum).forEach(key=>{\n    if(!/^\\$/.test(key)){\n      dest[key] = _cloneDeep(datum[key])\n    }\n  });\n  return dest;\n}\n\nconst getKeyWithValue = function(obj,value){\n  if(isArray(obj)){\n    for(var i=0,l=obj.length;i<l;i++) if(obj[i]===value) return i;\n  } \n  if(isObject(obj)){\n    for(var key in obj) if(obj[key]===value) return key;\n  }\n  return undefined;\n};\n\nexport const removeValue = function(obj,value){\n  var detect = true;\n  var array  = isArray(obj);\n\n  while(detect) {\n    var key = getKeyWithValue(obj,value);\n    if(typeof key === \"undefined\"){\n      detect = false;\n    } else {\n      if(array){\n        obj.splice(key,1);\n      } else {\n        delete obj[key];\n      }\n    }\n  }\n\n  return obj;\n};\n\nexport const instance = function(func,proto){\n  var ins,DummyInstance=function(param){ if(typeof param === \"object\") for(var k in param) this[k] = param[k]; };\n  if(typeof func == \"object\"){\n    if(typeof proto === \"object\") DummyInstance.prototype = proto;\n    ins = new DummyInstance(func);\n  }\n  if(typeof func == \"function\"){\n    if(typeof proto === \"object\") func.prototype = proto;\n    ins = (new func());\n  }\n  return ins;\n}\n\nexport const alloc = function(init) {\n  let fn = init();\n  const rn = function(...args) {\n    return fn.apply(this, args);\n  };\n  rn['reset'] = function() { fn = init(rn, rn); };\n  rn['$constructor'] = fn;\n  return rn;\n};\n\nconst syncData = (function(){\n  const ENTER_HOOK  = (newDatum)=>_.assign({}, newDatum);\n  const UPDATE_HOOK = (oldDatum, newDatum)=>_.assign({}, oldDatum, newDatum);\n  \n  return function(oldData, newData, getId, options) {\n    if(!/string|function/.test(typeof getId)) throw new Error(\"syncData need getId\");\n  \n    if(typeof getId === \"string\") {\n      const getIdString = getId;\n      getId = e=>_.get(e, getIdString);\n    }\n\n    oldData = asArray(oldData);\n    newData = asArray(newData);\n\n    const result = [];\n    const hooks  = asObject(options,\"afterEach\")\n    \n    if(typeof hooks[\"enter\"] !== \"function\"){\n      hooks[\"enter\"] = ENTER_HOOK;\n    }\n    \n    if(typeof hooks[\"update\"] !== \"function\"){\n      hooks[\"update\"] = UPDATE_HOOK;\n    }\n    \n    const oldDataMap = _.map(oldData, e=>{\n      return { id: getId(e), ref: e };\n    });\n    \n    \n    asArray(newData).forEach((newDatum, i)=>{\n      const newId = getId(newDatum);\n      let oldDatum = _.get(oldDataMap[_.findIndex(oldDataMap, e=>e.id === newId)], \"ref\");\n      let genDatum;\n      let dirty = false;\n\n      if(oldDatum) {\n        // change is not dirty, modify is dirty\n        if(typeof oldDatum !== typeof newDatum) {\n          dirty = false;\n        } else { // same type\n          const oldOwnKeys = Object.keys(oldDatum).filter(key=>!(key.indexOf(\"$\") === 0));\n          const newOwnKeys = Object.keys(newDatum).filter(key=>!(key.indexOf(\"$\") === 0));\n\n          // inspect key chnage\n          if(_.isEqual(oldOwnKeys, newOwnKeys)) {\n            dirty = !_.isEqual(_.pick(oldDatum, oldOwnKeys), _.pick(newDatum, newOwnKeys));\n          } else {\n            dirty = true;\n          }\n        }\n        \n        if(typeof hooks[\"beforeUpdate\"] === \"function\"){\n          if(hooks[\"beforeUpdate\"](oldDatum, newDatum) === false){\n            return;\n          }\n        }\n        \n        genDatum = hooks[\"update\"](oldDatum, newDatum);\n        \n        if(typeof hooks[\"afterUpdate\"] === \"function\"){\n          genDatum = hooks[\"afterUpdate\"](genDatum, oldDatum, newDatum);\n        }\n      } else {\n        if(typeof hooks[\"beforeEnter\"] === \"function\"){\n          if(hooks[\"beforeEnter\"](newDatum) === false){\n            return;\n          }\n        }\n        \n        genDatum = hooks[\"enter\"](newDatum);\n        \n        if(typeof hooks[\"afterEnter\"] === \"function\"){\n          genDatum = hooks[\"afterEnter\"](genDatum, newDatum);\n        }\n      }\n\n      if(typeof hooks[\"afterEach\"] === \"function\") {\n        hooks[\"afterEach\"](genDatum, i, dirty);\n      }\n\n      result.push(genDatum);\n    });\n\n    return result;\n  }\n}())"],"file":"cast.js"}